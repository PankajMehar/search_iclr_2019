Under review as a conference paper at ICLR 2019

WHEN WILL GRADIENT METHODS CONVERGE TO MAX-MARGIN CLASSIFIER UNDER RELU MODELS?
Anonymous authors Paper under double-blind review

ABSTRACT
We study the implicit bias of gradient descent methods in solving a binary classification problem over a linearly separable dataset. The classifier is described by a nonlinear ReLU model and the objective function adopts the exponential loss function. We first characterize the landscape of the loss function and show that there can exist spurious asymptotic local minima besides asymptotic global minima. We then show that gradient descent (GD) can converge to either a global or a local max-margin direction, or may diverge from the desired max-margin direction in a general context. For stochastic gradient descent (SGD), we show that it converges in expectation to either the global or the local max-margin direction if SGD converges. We further explore the implicit bias of these algorithms in learning a multi-neuron network under certain stationary conditions, and show that the learned classifier maximizes the margins of each sample pattern partition under the ReLU activation.

1 INTRODUCTION

It has been observed in various machine learning problems recently that the gradient descent (GD) algorithm and the stochastic gradient descent (SGD) algorithm converge to solutions with certain properties even without explicit regularization in the objective function. Correspondingly, theoretical analysis has been developed to explain such implicit regularization property. For example, it has been shown in Gunasekar et al. (2018; 2017) that GD converges to the solution with the minimum norm under certain initialization for regression problems, even without an explicit norm constraint.

Another type of implicit regularization, where GD converges to the max-margin classifier, has been recently studied in Gunasekar et al. (2018); Ji & Telgarsky (2018); Nacson et al. (2018a); Soudry et al. (2017; 2018) for classification problems as we describe below. Given a set of training samples zi = (xi, yi) for i = 1, . . . , n, where xi denotes a feature vector and yi  {-1, +1} denotes the corresponding label, the goal is to find a desirable linear model (i.e., a classifier) by solving the following empirical risk minimization problem

min
wRd

L(w) : = 1 n n
i=1

(yiw

xi).

(1)

It has been shown in Nacson et al. (2018a); Soudry et al. (2017; 2018) that if the loss function (·) is monotonically strictly decreasing and satisfies proper tail conditions (e.g., the exponential loss), and the data are linearly separable, then GD converges to the solution w with infinite norm and the maximum margin direction of the data, although there is no explicit regularization towards the maxmargin direction in the objective function. Such a phenomenon is referred to as the implicit bias of GD, and can help to explain some experimental results. For example, even when the training error achieves zero (i.e., the resulting model enters into the linearly separable region that correctly classifies the data), the testing error continues to decrease, because the direction of the model parameter continues to have an improved margin. Such a study has been further generalized to hold for various other types of gradient-based algorithms Gunasekar et al. (2018). Moreover, Ji & Telgarsky (2018) analyzed the convergence of GD with no assumption on the data separability, and characterized the implicit regularization to be in a subspace-based form.

The focus of this paper is on the following two fundamental issues, which have not been well addressed by existing studies.

1

Under review as a conference paper at ICLR 2019
· Existing studies so far focused only on the linear classifier model. An important question one naturally asks is what happens for the more general nonlinear leaky ReLU and ReLU models. Will GD still converge, and if so will it converge to the max-margin direction? Our study here provides new insights for the ReLU model that have not been observed for the linear model in the previous studies.
· Existing studies mainly analyzed the convergence of GD with the only exceptions Ji & Telgarsky (2018); Nacson et al. (2018b) on SGD. However, Ji & Telgarsky (2018) did not establish the convergence to the max-margin direction for SGD, and Nacson et al. (2018b) established the convergence to the max-margin solution only epochwisely for cyclic SGD (not iterationwise for SGD under random sampling with replacement). Moreover, both studies considered only the linear model. Here, our interest is to explore the iterationwise convergence of SGD under random sampling with replacement to the max-margin direction, and our result can shed insights for online SGD. Furthermore, our study provides new understanding for the nonlinear ReLU and leaky ReLU models.
1.1 MAIN CONTRIBUTIONS
We summarize our main contributions, where our focus is on the exponential loss function under ReLU model.
We first characterize the landscape of the empirical risk function under the ReLU model, which is nonconvex and nonsmooth. We show that such a risk function has asymptotic global minima and asymptotic spurious local minima. Such a landscape is in sharp contrast to that under the linear model previously studied in Soudry et al. (2017), where there exist only equivalent global minima.
Based on the landscape property, we show that the implicit bias property in the course of the convergence of GD can fall into four cases: converges to the asymptotic global minimum along the max-margin direction, converges to an asymptotic local minimum along a local max-margin direction, stops at a finite spurious local minimum, or oscillates between the linearly separable and misclassified regions without convergence. Such a diverse behavior is also in sharp difference from that under the linear model Soudry et al. (2017), where GD always converges to the max-margin direction.
We then take a further step to study the implicit bias of SGD. We show that the expected averaged weight vector normalized by its expected l2 norm converges to the global max-margin direction or local max-margin direction, as long as SGD stays either in the linearly separable region or in a region of the local minima defined by a subset of data samples with positive label. The proof here requires considerable new technical developments, which are very different from the traditional analysis of SGD, e.g., Bottou et al. (2016); Duchi & Singer (2009); Nemirovskii et al. (1983); Shalev-Shwartz et al. (2009); Xiao (2010); Bach & Moulines (2013); Bach (2014). This is because our focus here is on the exponential loss function without attainable global/local minima, whereas traditional analysis typically assumed that the minimum of the loss function is attainable. Furthermore, our goal is to analyze the implicit bias property of SGD, which is also beyond traditional analysis of SGD.
We further extend our analysis to the leaky ReLU model and multi-neuron networks.
1.2 RELATED WORK
Implicit bias of gradient descent: Gunasekar et al. (2018) studied the implicit bias of GD and SGD for minimizing the squared loss function under bounded global minimum, and showed that some of these algorithms converge to a global minimum that is closest to the initial point. Another collection of papers Gunasekar et al. (2018); Ji & Telgarsky (2018); Nacson et al. (2018a); Soudry et al. (2017); Telgarsky (2013); Soudry et al. (2018) characterized the implicit bias of algorithms for the loss functions without attainable global minimum. Telgarsky (2013) showed that AdaBoost converges to an approximate max-margin classifier. Soudry et al. (2017; 2018) studied the convergence of GD in logistic regression with linearly separable data and showed that GD converges in direction to the solution of support vector machine at a rate of 1/ ln(t). Nacson et al. (2018a) improved this rate to ln(t)/ t under the exponential loss via normalized gradient descent. Gunasekar et al. (2018) further showed that steepest descent can lead to margin maximization under generic norms. Ji & Telgarsky (2018) analyzed the convergence of GD on an arbitrary dataset, and provided the convergence rates
2

Under review as a conference paper at ICLR 2019

along the strongly convex subspace and the separable subspace. Our work studies the convergence of GD and SGD under the nonlinear ReLU model with the exponential loss, as opposed to the linear model studied by all the above previous work on the same type of loss functions.
Implicit bias of SGD: Ji & Telgarsky (2018) analyzed the average SGD (under random sampling) with fixed learning rate and proved the convergence of the population risk, but did not establish the parameter convergence of SGD in the max-margin direction. Nacson et al. (2018b) established the convergence of cyclic SGD epochwisely in direction to the max-margin classifier at a rate O(1/ ln t). Our work differs from these two studies first in that we study the ReLU model, whereas both of these studies analyzed the linear model. Furthermore, we showed that under SGD with random sampling, the expectation of the averaged weight vector converges in direction to the max-margin classifier at a rate O(1/ ln t).
Generalization of SGD: There have been extensive studies of the convergence and generalization performance of SGD under various models, of which we cannot provide a comprehensive list due to the space limitations. In general, these type of studies either characterize the convergence rate of SGD or provide the generalization error bounds at the convergence of SGD, e.g., Brutzkus et al. (2017); Wang et al. (2018); Li & Liang (2018), but did not characterize the implicit regularization property of SGD, such as the convergence to the max-margin direction as provided in our paper.

2 RELU CLASSIFICATION MODEL

We consider the binary classification problem, in which we are given a set of training samples {z1, . . . , zn}. Each training sample zi = (xi, yi) contains an input data xi and a corresponding binary label yi  {-1, +1}. We denote I+ := {i : yi = +1} as the set of indices of samples with label +1 and denote I- := {i : yi = -1} in a similar way. Their cardinalities are denoted as n+ and n-, respectively, and are assumed to be non-zero. We consider all datasets that are linearly separable, i.e., there exists a linear classifier w such that yiw xi > 0 for all i = 1, . . . , n.

We are interested in training a ReLU model for the classification task. In specific, for a given input data x, the model outputs (w xi), where (v) = max{0, v} is the ReLU activation function and w denotes the weight parameters. The predicted label is set to be sgn(w x). Our goal is to
learn a classifier by solving the following empirical risk minimization problem, where we adopt the
exponential loss.

min L(w) := 1 n

wRd

n
i=1

(w, zi),

where

(w, zi) = exp(-yi(w xi)).

(P)

The ReLU activation causes the loss function in problem (P) to be nonconvex and nonsmooth. Therefore, it is important to first understand the landscape property of the loss function, which is critical for characterizing the implicit bias property of the GD and SGD algorithms.

3 IMPLICIT BIAS OF GD IN LEARNING RELU MODEL

3.1 LANDSCAPE OF RELU MODEL

In order to understand the convergence of GD under the ReLU model, we first study the landscape of the loss function in problem (P), which turns out to be very different from that under the linear activation model. As been shown in Soudry et al. (2017); Ji & Telgarsky (2018), the loss function in problem (P) under linear activation is convex, and achieves asymptotic global minimum, i.e., L(w)  0 and L(w)  0 as the scaling constant   +, only if w is in the linearly separable region. In contrast, under the ReLU model, the asymptotic critical points can be either global minimum or (spurious) local minimum depending on the training datasets, and hence the convergence property of GD can be very different in nature from that under the linear model.

The following theorem characterizes the landscape properties of problem (P). Throughout, we de-

note the infimum of the objective function in problem (P) as L direction w asymptotically critical if it satisfies L(w)0 as

=

n- n

.

Furthermore,

  +.

we

call

a

3

Under review as a conference paper at ICLR 2019

Theorem 3.1 (Asymptotic landscape property). For problem (P) under the ReLU model, any corresponding asymptotic critical direction w fall into one of the following cases:

1. (Asymptotic global minimum): yiw xi > 0 for all i  I+  I-. Then, L(w)  L as   +.

2. (Asymptotic local minimum): w xi > 0 for all i  J+ and w xi  0 for all i  (I+ \ J+)  I-, where J +  I+. Then,

L(w)



L

+

n+-|J +| n

as





+.

3. (Local minimum): w xi  0 for all i  I+  I-. Then,

L(w)

=

L

+

n+ n

.

To further elaborate Theorem 3.1, if w classifies all data correctly (i.e., item 1), then the objective function possibly achieves global minimum L along this direction. On the other hand, if w classifies some data with label +1 as -1 (item 2), then the objective function achieves a sub-optimal value along this direction. In the worst case where all data samples are classified as -1 (item 3), the ReLU unit is never activated and hence the corresponding objective function has constant value 1. We note that the cases in items 2 and 3 may or may not take place depending on specific datasets, but if they do occur, the corresponding w are spurious (asymptotic) local minima. In summary, the landscape under the ReLU model can be partitioned into different regions, where gradient descent algorithms can have different implicit bias as we show next.

3.2 CONVERGENCE OF GD

In this subsection, we analyze the convergence of GD in learning the ReLU model. At each iteration t, GD performs the update

wt+1 = wt - L(wt),

(GD)

where  denotes the stepsize. For the linear model whose loss function has infinitely many asymptotic global minima, it has been shown in Soudry et al. (2017) that GD always converges to the max-margin direction. Such a phenomenon is regarded as the implicit bias property of GD. Here, for the ReLU model, we are also interested in analyzing whether such an implicit-bias property still holds. Furthermore, since the loss function under the ReLU model possibly contains spurious asymptotic local minima, the convergence of GD under the ReLU model should be very different from that under the linear model.

Next, we introduce various notions of margin in order to characterize the implicit bias under the ReLU model. The global max-margin direction of samples in I+ is defined as
w+ = arg min max(w xi).
w =1 iI+

Such a notion of max-margin is natural because the ReLU activation function can suppress negative

inputs. We note that here w+ may not locate in the linearly separable region, and hence it may not

be parallel to any (asymptotic) global minimum. As we show next, only when w+ is in the linearly

separable region, GD may converge in direction to such a max-margin direction under the ReLU

model. Furthermore, for each given subset J+  I+, we define the associated local max-margin

direction wJ+ as

wJ+

=

arg min max(w
w =1 iJ+

xi).

We further denote the set of asymptotic local minima with respect to J+  I+ (see Theorem 3.1 item 2) as

WJ+ := {w xi > 0, i  J + and w xi  0, i  (I+ \ J +)  I-}.

Of course, WJ+ may or may not be empty for a certain J+, and wJ+ may or may not belong to WJ+ depending on the specific training dataset. As we show next, only when there exists a non-empty WJ+ and the corresponding wJ+  WJ+, GD may converge to such an asymptotic local minimum wJ+ direction under the ReLU model. Next, we present the implicit bias of GD for learning the ReLU model in problem (P).

4

Under review as a conference paper at ICLR 2019

Theorem 3.2. Apply GD to solve problem (P) with arbitrary initialization and a small enough constant stepsize. Then, the sequence {wt}t generated by GD falls into one of the following cases.

1. L(wt)  L, and

wt wt

- w+

=

O(

ln ln t ln t

)

,

where

w+

is

in

linearly

separable

region;

2. the direction of wt does not converge and oscillates between linearly separable and misclassified regions, where w+ is not in linearly separable region;

3.

L(wt)  L +

n+-|J +| n

,

and

wt wt

- wJ+

=

O(

ln ln ln t

t

)

,

where

J+

=

,

and

wJ+



WJ+;

4.

L(wt) = L +

n+ n

,

and

wt

= w^ J+, where J +

= , i.e., GD terminates within finite steps.

Theorem 3.2 characterizes various instances of implicit bias of GD in learning the ReLU model, which the nature of the convergence is different from that in learning the linear model. In specific, GD can either converge in direction to the global max-margin direction w+ that leads to the global minimum, or converge to the local max-margin direction wJ+ that leads to a spurious local minimum. Furthermore, it may occur that GD oscillates between the linearly separable region and the misclassified region due to the suppression effect of ReLU function. In this case, GD does not have an implicit bias property and convergence guarantee. We provide two simple examples in the supplementary material to further elaborate these cases.

3.3 IMPLICIT BIAS OF SGD IN LEARNING RELU MODELS

In this subsection, we analyze the convergence property and the implicit bias of SGD for solving problem (P). At each iteration t, SGD samples an index t  {1, . . . , n} uniformly at random with replacement, and performs the update

wt+1 = wt - t (wt, zt ).

(SGD)

Similarly to the convergence of GD characterized in Theorem 3.2, SGD may oscillate between the linearly separable and misclassified regions. Therefore, our major interest here is the implicit bias of SGD when it does converge either to the asymptotic global minimum or local minimum. Thus, without loss of generality, we implicitly assume that w+ is in the linearly separable region, and the relevant wJ+  WJ+. Otherwise, SGD does not even converge.
The implicit bias of SGD with replacement sampling has not been studied in the existing literature, and the proof of the convergence and the characterization of the implicit bias requires substantial new technical developments. In particular, traditional analysis of SGD under convex functions requires the assumption that the variance of the gradient is bounded Bottou et al. (2016); Bach (2014); Bach & Moulines (2013). Instead of making such an assumption, we next prove that SGD enjoys a nearlyconstant bound on the variance up to a logarithmic factor of t in learning the ReLU model.

Proposition 1 (Variance bound). Apply SGD to solve problem (P) with any initialization. If there

exists T such that with stepsize k =

for all t > T , wt either stays (k + 1)- where 0.5 <  < 1,

in the linearly separable region, or in WJ+, then the variances of the stochastic gradients sampled

by SGD along the iteration path satisfy that for all t,

t-1
k2E  (wk, zk ) 2  O

ln t 2

.

k=0

Proposition 1 shows that the summation of the norms of the stochastic gradients grows logarithmi-

cally fast. This implies that the variance of the stochastic gradients is well-controlled. In particular, if

we choose k = (k+1)-1/2, then the bound in Proposition 1 implies that the term E  (wk, zk ) 2 stays at a constant level. Based on the variance bound in Proposition 1, we next establish the con-

vergence

rate

of

SGD

for

learning

the

ReLU

model.

Throughout,

we

denote

wt

:=

1 t

t-1 k=0

wk

as

the averaged iterates generated by SGD.

Theorem 3.3 (Convergence rate of loss). Apply SGD to solve problem (P) with any initialization. If there exist T such that for all t > T , wt either stays in the linearly separable region, or in WJ+,

5

Under review as a conference paper at ICLR 2019

then with the stepsize k = (k + 1)-, where 0.5 <  < 1, the averaged iterates generated by SGD

satisfies

EL(wt) - L  O

ln2 t t1-

,

Ewt  O(ln t).

If there exist T such that for all t > T , wt stays in WJ+, then with the same stepsize

EL(wt) -

L + n+ - |J +| n

O

ln2 t t1-

,

Ewt  O(ln t).

Theorem 3.3 establishes the convergence rate of the expected risk of the averaged iterates generated

by SGD. It can be seen that the convergence of SGD achieves different loss values corresponding to

global and local minimum in different regions. The stepsize is set to be diminishing to compensate

the variance convergence

introduced by rate is nearly

SGD. of the

IonrdpearrtOic(ullna2r,ti/fti)s,

chosen which

to be sufficiently close to 0.5, matches the standard result of

then the SGD in

convex optimization up to an logarithmic order. Theorem 3.3 also implies that the convergence of

SGD is attained as Ewt  + at a rate of O(ln t). We note that the analysis of Theorem 3.3 is

different from that of SGD in traditional convex optimization, which requires the global minimum

to be achieved at a bounded point and assumes the variance of the stochastic gradients is bounded

by a constant Shalev-Shwartz et al. (2009); Duchi & Singer (2009); Nemirovski et al. (2009). These

assumptions do not hold here.

Theorem 3.4 (Implicit bias of SGD). Apply SGD to solve problem (P) with any initialization. If

there exist T then with the

ssutecphsitzheatkfor=al(lkt+>1T)-,wwt heeirthe e0r.5sta<ysin<th1e ,litnheeasrelyquseenpcaeraobflethreegaivoenr,agoerdiniteWraJ+te,

{wt}t generated by SGD satisfies

Ewt

2
- w+ = O

1

.

Ewt ln t

If there exist T such that for all t > T , wt stays in WJ+, then with the same stepsize

Ewt Ewt

2
- wJ+ = O

1 ln t

.

Theorem 3.4 shows that the direction of the expected averaged iterate E[wt] generated by SGD converges to the max-margin direction w+, without any explicit regularizer in the objective function. The proof of Theorem 3.4 requires a detailed analysis of the SGD update under the ReLU model and is substantially different from that under the linear model Soudry et al. (2018); Ji & Telgarsky (2018); Nacson et al. (2018a;b). In particular, we need to handle the variance of the stochastic gradients introduced by SGD and exploit its classification properties under the ReLU model.

We next provide an example class of datasets (which has been studied in Combes et al. (2018)), for which we show that SGD stays stably in the linearly separable region.
Proposition 2. If the linear separable samples {z1, . . . , zn} satisfy the following conditions given in Combes et al. (2018):

1. 2.

For For

all all

(i, (i,

j) j)

 

I+ I+

× ×

I+ I-

 

I- I-

× ×

I-, I+,

it it

holds holds

that that

xi xi

xj xj

> 0; < 0,

then there exists a t¯  N such that for all t  t¯ the sequence generated by SGD stays in the linearly separable region, as long as SGD is not initialized at the local minima described in item 3 of Theorem 3.1.

4 FURTHER EXTENSIONS AND DISCUSSIONS
4.1 LEAKY RELU MODELS
The leaky ReLU activation takes the form (v) = max(v, v), where the parameter (0    1). Clearly, leaky ReLU takes the linear and ReLU models as two special cases, respectively corresponding to  = 0 and  = 1. Since the convergence of GD/SGD of the ReLU model is very

6

Under review as a conference paper at ICLR 2019

different from that of the linear model, a natural question to ask is whether leaky ReLU with intermediate parameters 0 <  < 1 takes the same behavior as the linear or ReLU model.

It can be shown that the loss function in problem (P) under the leaky ReLU model has only asymptotic global minima achieved by w in the separable region with infinite norm (there does not exist asymptotic local minima). Hence, the convergence of GD is similar to that under the linear model, where the only difference is that the max-margin classifier needs to be defined based on leaky ReLU as follows.

For the given set of in which xi = xi,

linearly separable data samples, i  I+, xi = xi, i  I-,

we and

construct a new yi = yi, i 

set I+

of 

data I-.

zi = (xi , yi), Essentially, the

data samples with label -1 are scaled by the parameter  of leaky ReLU. Without loss of generality,

we assume translation.

Tthhaetnt,hwe emdaexfi-nmeatrhgeinmcalxa-smsifiaregrinfodrirdeacttaio{nxoif}dpataassXes

through as

the

origin

after

a

proper

w

=

arg min
w =1

max
iI + I

-

(yi

w

xi ).

Then, following the result under the linear model in Soudry et al. (2017), it can be shown that

GD with arbitrary initialization and small constant stepsize for solving problem (P) under the leaky

ReLU model satisfies that L(w) converges to zero, and w converges to the max-margin direction,

i.e., limt

wt wt

= w, with its norm going to infinity.

Furthermore, following our result of Theorem 3.4, it can be shown that for SGD applied to solve
problem (P) with any initialization, if there exists T such that for all t > T wt stays in the linearly separable region, then with the stepsize k = (k + 1)-, 0.5 <  < 1, the sequence of the averaged iterate {wt}t generated by SGD satisfies

Ewt

2
- w = O

1

.

Ewt ln t

Thus, for SGD under the leaky ReLU model, the normalized average of the parameter vector converges in direction to the max-margin classifier.

4.2 MULTI-NEURON NETWORKS

In this subsection, we extend our study of the ReLU model to the problem of training a one-hiddenlayer ReLU neural network with K hidden neurons for binary classification. Here, we do not assume linear separability of the dataset. The output of the network is given by

K
f (x) = vk(wkx) = v (W x),
k=1

(2)

where W = [ w1, w2, · · · , wK ] with each column wk representing the weights of the kth neuron in the hidden layer, v = [ v1, v2, · · · , vK ] denotes the weights of the output neuron, and (·) represents the entry-wise ReLU activation function. We assume that v is a fixed vector whose
entries are nonzero and have both positive and negative values. Such an assumption is natural as it
allows the model to have enough capacity to achieve zero loss. The predicted label is set to be the
sign of f (x), and the objective function under the exponential loss is given by

1n

L(W) = n

exp(-yif (xi)).

i=1

(3)

Our goal is to characterize the implicit bias of GD and SGD for learning the weight parameters W of the multi-neuron model. In general, such a problem is challenging, as we have shown that GD may not converge to a desirable classifier even under the single-neuron ReLU model. For this reason, we adopt the same setting as that in (Soudry et al., 2017, Corollary 8), which assumes that the activated neurons do not change their activation status and the training error converges to zero after a sufficient number of iterations, but our result presented below characterizes the implicit bias of GD and SGD in the original feature space, which is different from that in (Soudry et al., 2017, Corollary 8). We define a set of vectors {Ai  Rk×1}ni=1, where Aij = 1 if the sample xi is activated on the jth

7

Under review as a conference paper at ICLR 2019

neuron, i.e., wj xi > 0, and set Aji = 0 otherwise. Such an Ai vector is referred to as the activation pattern of xi. We then partition the set of all training samples into m subsets B1, B2, · · · , Bm, so that
the samples in the same subset have the same ReLU activation pattern, and the samples in different
subsets have different ReLU activation patterns. We call Bh, h  [m] as the h-th pattern partition. Let wh = k{j:Ahj =1} vkwk. Then, for any sample x  Bh, the output of the network is given by

K

f (x) = vk(wkx) =

vkwk x = whx.

k=1

k{j:Ahj =1}

We next present our characterization of the implicit bias property of GD and SGD under the above ReLU network model. We define the corresponding max-margin direction of the samples in Bh as

wh = arg min max(w x).
w =1 xBh

Then the following theorem characterizes the implicit bias of GD under the multi-neuron network.
Theorem 4.1. Suppose that GD optimizes the loss L(W) in eq. (3) to zero and there exists T such that for all t > T , the neurons in the hidden layer do not change their activation status. If Ah1  Ah2 = 0 (where "" denotes the entry-wise logic operator "AND" between digits zero or one) for any h1 = h2, then the samples in the same pattern partition of the ReLU activation have the same label, and

wht wht

- wh

=O

ln ln t ln t

,

for all h  [m] .

Differently from (Soudry et al., 2017, Corollary 8) which studies the convergence of the vectorized

weight matrix so that the implicit bias of GD is with respect to features being lifted to an extended

dimensional space, Theorem 4.1 characterizes the convergence of the weight parameters and the

implicit bias in the original feature space. In particular, Theorem 4.1 implies that although the ReLU

neural network is a nonlinear classifier, f (x) is equivalent to a ReLU classifier for the samples in

the same pattern partition (that are from the same class), which converges in direction to the max-

margin

classifier

wh

of

those

data

samples.

We

next

let

w ht

:=

1 t

t-1 k=0

wh(t).

Then

the

following

theorem establishes the implicit bias of SGD.

Theorem 4.2. Suppose that SGD optimizes the loss L(W) in eq. (3) so that there exists T such that
for any t > T , L(W) < 1/n, the neurons in the hidden layer do not change their activation status, and for any h1 = h2, Ah1  Ah2 = 0. Then, for the stepsize k = (k + 1)-, 0.5 <  < 1, the samples in the same pattern partition of the ReLU activation have the same label, and

Ew ht Ew ht

2
- wh = O

1 ln t

,

for all h  [m] .

Similarly to GD, the averaged SGD in expectation maximizes the margin for every sample partition. At the high level, Theorem 4.1 and Theorem 4.2 imply the following generalization performance of the ReLU network under study. After a sufficiently large number of iterations, the neural network partitions the data samples into different subsets, and for each subset, the distance from the samples to the decision boundary is maximized by GD and SGD. Thus, the learned classifier is robust to small perturbations of the data, resulting in good generalization performance.

5 CONCLUSION
In this paper, we study the problem of learning a ReLU neural network via gradient descent methods, and establish the corresponding risk and parameter convergence under the exponential loss function. In particular, we show that due to the possible existence of spurious asymptotic local minima, GD and SGD can converge either to the global or local max-margin direction, which in the nature of convergence is very different from that under the linear model in the previous studies. We also discuss the extensions of our analysis to the more general leaky ReLU model and multi-neuron networks. In the future, it is worthy to explore the implicit bias of GD and SGD in learning multilayer neural network models and under more general (not necessarily linearly separable) datasets.

8

Under review as a conference paper at ICLR 2019
REFERENCES
Francis Bach and Eric Moulines. Non-strongly-convex smooth stochastic approximation with convergence rate O(1/n). In Proc. Advances in neural information processing systems (NIPS), 2013.
Francis R Bach. Adaptivity of averaged stochastic gradient descent to local strong convexity for logistic regression. Journal of Machine Learning Research, 15(1):595­627, 2014.
Jonathan Borwein and Adrian S Lewis. Convex analysis and nonlinear optimization: theory and examples. Springer Science & Business Media, 2010.
Le´on Bottou, Frank E Curtis, and Jorge Nocedal. Optimization methods for large-scale machine learning. arXiv preprint arXiv:1606.04838, 2016.
Alon Brutzkus, Amir Globerson, Eran Malach, and Shai Shalev-Shwartz. Sgd learns overparameterized networks that provably generalize on linearly separable data. arXiv preprint arXiv:1710.10174, 2017.
Remi Tachet des Combes, Mohammad Pezeshki, Samira Shabanian, Aaron Courville, and Yoshua Bengio. On the learning dynamics of deep neural networks. arXiv preprint arXiv:1809.06848, 2018.
John Duchi and Yoram Singer. Efficient online and batch learning using forward backward splitting. Journal of Machine Learning Research, 10:2899­2934, 2009.
Suriya Gunasekar, Blake E Woodworth, Srinadh Bhojanapalli, Behnam Neyshabur, and Nati Srebro. Implicit regularization in matrix factorization. In Proc. Advances in Neural Information Processing Systems (NIPS), 2017.
Suriya Gunasekar, Jason Lee, Daniel Soudry, and Nathan Srebro. Characterizing implicit bias in terms of optimization geometry. ArXiv:1802.08246, 2018.
Ziwei Ji and Matus Telgarsky. Risk and parameter convergence of logistic regression. ArXiv:1803.07300, 2018.
Yuanzhi Li and Yingyu Liang. Learning overparameterized neural networks via stochastic gradient descent on structured data. arXiv preprint arXiv:1808.01204, 2018.
Mor Shpigel Nacson, Jason Lee, Suriya Gunasekar, Nathan Srebro, and Daniel Soudry. Convergence of gradient descent on separable data. ArXiv:1803.01905, 2018a.
Mor Shpigel Nacson, Nathan Srebro, and Daniel Soudry. Stochastic gradient descent on separable data: Exact convergence with a fixed learning rate. arXiv preprint arXiv:1806.01796, 2018b.
Arkadi Nemirovski, Anatoli Juditsky, Guanghui Lan, and Alexander Shapiro. Robust stochastic approximation approach to stochastic programming. SIAM Journal on Optimization, 19(4):1574­ 1609, 2009.
Arkadii Nemirovskii, David Borisovich Yudin, and Edgar Ronald Dawson. Problem complexity and method efficiency in optimization. Wiley, 1983.
Shai Shalev-Shwartz, Ohad Shamir, Nathan Srebro, and Karthik Sridharan. Stochastic convex optimization. In Proc. Conference on Learning Theory (COLT), 2009.
Daniel Soudry, Elad Hoffer, and Nathan Srebro. The implicit bias of gradient descent on separable data. ArXiv:1710.10345, 2017.
Daniel Soudry, Elad Hoffer, and Nathan Srebro. The implicit bias of gradient descent on separable data. In Proc. International Conference on Learning Representations (ICLR), 2018.
Matus Telgarsky. Margins, shrinkage, and boosting. In Proc. International Conference on Machine Learning (ICML), 2013.
Gang Wang, Georgios B Giannakis, and Jie Chen. Learning relu networks on linearly separable data: Algorithm, optimality, and generalization. arXiv preprint arXiv:1808.04685, 2018.
Lin Xiao. Dual averaging methods for regularized stochastic learning and online optimization. Journal of Machine Learning Research, 11:2543­2596, 2010.
9

Under review as a conference paper at ICLR 2019

Supplementary Materials

A PROOF OF THEOREM 3.1

The gradient L(w) is given by

L(w) = 1 n

n



(w, zi)

=

-1 n

n

yi1{w xi>0} exp(-yiw xi)xi.

i=1 i=1

If yiw xi  0 for all xi  I+  I-, then as   +, we have, ,

L(w) = 1

exp(0) = n- = L,

nn

iI -

and

L(w) = - 1 n

exp(-w xi)xi = 0.

iI +

Recall that J+  I+. If w xi  0 for all i  (I+ \ J+)  I-, then as   +, we obtain

L(w) = 1

exp(0)

=

n+

- |J +| + n-

=

L

+

n+

- |J +| .

n nn

i(I+\J +)I-

and

L(w) = - 1 n

exp(-w xi)xi = 0.

iJ +

If w xi  0 for all i  I+  I-, then

L(w) = 1

n

exp(0)

=

1

=

L

+

n+ ,

L(w)

=

0.

nn

i=1

The proof is now complete.

B PROOF OF THEOREM 3.2

First consider the case when w+ is in linearly separable region and the local minimum does not exist along the updating path. We call the region where all vectors w  Rd satisfy w xi < 0 for all i  I- as negative correctly classified region. As shown in Soudry et al. (2017), L(w) is
non-negative and L-smooth, which implies that

L(wk+1)  L(wk) + L(wk)

(wk+1

-

wk )

+

L 2

wk+1 - wk

2

= L(wk) - 

L(wk )

2+

L2 2

L(wk) 2

= L(wk) - (1 -

L )
2

L(wk )

2.

Based on the above inequality, we have

L(wk) - L(wk+1)

(1

-

L 2

)



L(wk) 2,

which, in conjunction with 0 <  < 2/L, implies that

t k=0

L(wk )

2



t k=0

L(wk) - L(wk+1)

(1

-

L 2

)

=

L(w0) - L(wt+1)

(1

-

L 2

)

.

Thus, we have L(wk) 2  0 as k  +. By Theorem 3.1, L(wk) vanishes only when all samples with label -1 are correctly classified, and thus GD enters into the negative correctly

10

Under review as a conference paper at ICLR 2019

classified region eventually and diverges to infinity. Soudry et al. (2017) Theorem 3 shows that when GD diverges to infinity, it simultaneously converges in the direction of the max-margin classifier of all samples satisfying wt xi > 0. Thus, under our setting, GD either converges in the direction of the global max-margin classifer w+:

wt - w+ = O ln ln t , wt ln t

or the local max-margin classifier wJ+:

wt wt

- wJ+

=O

ln ln t ln t

.

Next, consider the case when w+ is not in linearly separable region, and the local minimum does not exist along the updating path. In such a case, we conclude that GD cannot stay in the linearly separable region. Otherwise, it converges in the direction of w+ that is not in linearly separable region, which leads to a contradiction. If the asymptotic local minimum wJ+ exists, then GD may converge in its direction. If wJ+ does not exist, GD cannot stay in both the misclassified region and linearly separable region, and thus oscillates between these two regions.
In the case when GD reaches a local minimum, by Theorem 3.1, we have L(w) = 0, and thus GD stops immediately and does not diverges to infinity.

C EXAMPLES OF CONVERGENCE OF GD IN RELU MODEL

Example 1 (Figure 1, left). The dataset consists of two samples with label +1 and one sample with label -1. These samples satisfy x1 x3 < 0 and x1 x2 < 0.
For this example, if we initialize GD at the green classifier, then GD converges to the max-margin direction of the sample (x1, +1). Clearly, such a classifier misclassifies the data sample (x2, +1). Example 2 (Figure 1, right). The dataset consists of one sample with label +1 and one sample with label -1. These two samples satisfy 0 < x1 x2  0.5 x2 2.
For this example, if we initialize at the green classifier, then GD oscillates around the direction x2/ x2 and does not converge.

Convergence of GD to bad direction 6
4 w0 w2000
2 maximum margin classifier of x 1
0
-2

Oscillation of GD 3
w 0
w 2 3484
w 3485
1
0
-1
-2

-4 -4 -2 0 2 4 6

-3 -2 -1 0 1 2 3 4

Figure 1: Failure of GD in learning ReLU models

PROOF OF EXAMPLE 1

Consider the first iteration. Note that the sample z3 has label -1, and from the illustration of Figure 1
(left) we have w0 x3 < 0, w0 x2 < 0 and w0 x1 > 0. Therefore, only the sample z1 contributes to the gradient, which is given by

w0 L(w0) = - exp(-w0 x1)x1.

(4)

11

Under review as a conference paper at ICLR 2019

By the update rule of GD, we obtain that for all t

wt+1 = wt +  exp(-wt x1)x1.

(5)

By telescoping eq. (5), it is clear that any wt x2 < 0 for all t since x1 x2 < 0. This implies that the sample z2 is always misclassified.

PROOF OF EXAMPLE 2

Since we initialize GD at w0 such that w0 x1 > 0 and w0 x2 < 0, the sample z2 does not contribute to the GD update due to the ReLU activation. Next, we argue that there must ex-

ists a t such that wt x2 > 0. Suppose such t does not exist, we always have wt x1 = (w0 +

t-1 k=0

exp(-wk

x1

)x1)

x1

> 0.

Then, the linear classifier wt

generated by GD stays between x1

and x2, and the corresponding objective function reduces to a linear model that depends on the sam-

ple z1 (Note that z2 contributes a constant due to ReLU activation). Following from the results in

Ji & Telgarsky (2018); Soudry et al. (2017) for linear model, we conclude that wt converges to the

max-margin direction

x1 x1

as t  +. Since x1 x2 > 0, this implies that wt x2 > 0 as t  +,

contradicting with the assumption.

Next, we consider the t such that wt x1 > 0 and wt x2 > 0, the objective function is given by L(wt) = exp(-wt x1) + exp(wt x2),
and the corresponding gradient is given by

wt L(wt) = - exp(-wt x1)x1 + exp(wt x2)x2.

Next, we consider the case that wt x1 > 0 for all t. Otherwise, both of x1 and x2 are on the negative side of the classifier and GD cannot make any progress as the corresponding gradient is zero. In the
case that wt x1 > 0 for all t, by the update rule of GD, we obtain that

wt+1x2 - wt x2 =  exp(-wt x1)x1 x2 -  exp(wt x2) x2 2  -0.5 x2 2.

(6)

Clearly, the sequence {wt x2}t is strictly decreasing with a constant gap, and hence within finite steps we must have wt x2  0.

D PROOF OF PROPOSITION 1

Since SGD stays in the linearly separable region eventually, and hence only the data samples in I+ contribute to the gradient update due to the ReLU activation function. For this reason, we reduce the original minimization problem (P) to the following optimization

min L(w)
wRd

=

1 n+

n i=1

(w, xi),

(w, xi) = exp(-w xi)1(xiI+),

(7)

which corresponds the data samples in

to a linear model J+ contribute the

with samples in I+. Similarly, the gradient update, the original

if SGD stays in WJ+, only minimization problem (P) is

reduced to

1n

min L(w) =

wRd

|J +|

(w, xi),

i=1

(w, xi) = exp(-w xi)1(xiJ+),

(8)

The proof contains three main steps.

Step 1: For any u, bounding the term E wt - u 2: By the update rule of SGD, we have

wt - u 2 = =

wt-1 - u 2 - 2t-1  (wt-1, zt ), wt-1 - u + t2-1  (wt-1, zt ) 2
wt-1 - u 2 - 2t-1 L(wt-1), wt-1 - u + t2-1  (wt-1, zt ) 2 + Mt, (9)

12

Under review as a conference paper at ICLR 2019

where Mt = 2t-1 L(wt-1) -  (wt-1, zt ), wt-1 - u .
By convexity we obtain that L(wt-1), wt-1 - u  L(wt-1) - L(u). Then, eq. (9) further becomes
wt - u 2  wt-1 - u 2 - 2t-1(L(wt-1) - L(u)) + t2-1  (wt-1, zt ) 2 + Mt (10)
Telescoping the above inequality yields that

t-1 t-1 t-1

t

wt - u 2  w0 - u 2 - 2 kL(wk) + 2( k)L(u) + k2  (wk, zk ) 2 + Mk.

k=0

k=0

k=0

k=1
(11)

Taking expectation on both sides of the above inequality and note that EMt = 0 for all t, we further

obtain that

E wt - u 2 

t-1 t-1 t-1

w0 - u 2 - 2 kEL(wk) + 2( k)L(u) + k2E  (wk, zk ) 2.

k=0

k=0

k=0

(12)

Note that  1 whenever the data samples are correctly classified and for all i  I+, xi  B, and without loss of generality, we can assume B < 2. Hence, the term E  (wk, zk ) 2 can be upper bounded by

E  (wk, zk ) 2 = E (wk, zk ) z2k  B2E (wk, zk )2  B2E (wk, zk ) = B2EL(wk). Then, noting that k  1, eq. (12) can be upper bounded by

t-1 t-1
E wt - u 2  w0 - u 2 - (2 - B2) kEL(wk) + 2( k)L(u).

k=0

k=0

(13)

Next, set u = (ln(t)/)w^ + and note that w^ +xi   for all i  I+, we conclude that L(u) =

(1/n+)

exp(-u

xi) 

1 t

.

Substituting this into the above inequality and noting that k

=

iI +

(k + 1)- and 0.5 <  < 1, we further obtain that

E wt - u 2  

w0

2

+

ln2 t 2

+

t-1
2(

1 k) t

-

(2

-

B2)

t-1

k EL(wk )

k=0

k=0

w0

2

+

ln2 t 2

+

(1

2 -

t- )

-

(2

-

B2)

t-1

k EL(wk ).

k=0

(14)

Step 2: lower bounding E wt - u 2: Note that only the samples in I+ contribute to the update rule. By the update rule of SGD, we obtain that

t-1 t-1

wt = w0 - k (wk, zk ) = w0 + k (wk, zk )xk ,

k=0

k=0

which further implies that

t-1 t-1

wt w^ + = w0 w^ + + k (wk, zk )xk w^ +  w0 w^ + +  k (wk, zk ).

k=0

k=0

Then, we can lower bound wt - u as

wt - u



wt - u, w^ +



wt

w^ +

-

ln(t)  w^ +w^ +

t-1 ln(t)  w0 w^ + +  k (wk, zk ) -  .
k=0

13

Under review as a conference paper at ICLR 2019

Taking the expectation of wt - u 2:

E wt - u 2  E

t-1 ln(t) w0 w^ + +  k (wk, zk ) - 

2

k=0

(i)


w0

w^ +

+



t-1

k E

(wk, zk )

-

ln(t) 

2

k=0

=

w0

w^ +

+



t-1

k EL(wk )

-

ln(t) 

2
,

k=0

where (i) follows from Jensen's inequality.
t-1
Step 3: Upper bounding kEL(wk): Combining the upper bound obtained in step 1 and the
k=0
lower bound obtained in step 2 yields that

w0

w^ +

+



t-1

k EL(wk )

-

ln(t) 

2


w0

2

+

ln2 t 2

+

1

2 -



t-

-

(2

-

B2)

t-1

k EL(wk ).

k=0

k=0

Solving the above quadratic inequality yields that

t-1
kEL(wk)  O

ln t 2

.

k=0

(15)

E PROOF OF THEOREM 3.3

The proof exploits the iteration properties of SGD and the bound on the variance of SGD established in Proposition 1.
We start the proof from eq. (10), following which we obtain

L(wt-1) 

1 (
2t-1

wt-1 - u

2-

wt - u

2) + L(u) +

1 2 t-1



(wt-1, zt )

2

+

1 2t-1

Mt.

(16)

Taking the expectation on both sides of the above inequality yields that

EL(wt-1) 

1 2t-1 (E

wt-1 - u

2-E

wt - u

2) + L(u) +

1 2 t-1E



(wt-1, zt )

2,

which, after telescoping, further yields that

t-1 1 t-1 1 k=0 EL(wk)  tL(u) + 2 k=0 k (E

wk - u

2-E

wk+1 - u

2)

+

1 2

t-1

k E

k=0



(wk, zk )

2.

(17)

14

Under review as a conference paper at ICLR 2019

t-1 t-1

By convexity of L in the linearly separable region, we have L

1 t

wk



1 t

L(wk), which,

k=0

k=0

in conjunction with eq. (17), yields that

EL

1 t-1 t wk

k=0

 L(u) +

1 t-1 1 2t k=0 k (E

wk - u

2-E

wk+1 - u

2)

+

B2 2t

t-1

k EL(wk )

k=0

= L(u) +

1 2t

t-1
k(E

wk - u

2-E

wk+1 - u

2) + B2 2t

t-1
k EL(wk )

k=0

k=0

= L(u) +

1 2t

t-1
[(k + 1) - k] E

wk - u

2 - tE

wt - u

2+

B2 2t

t-1
k EL(wk )

k=0

k=0

 L(u) +

1 2t

t-1

(k + 1)2 - k2 (k + 1) + k E

wk - u

2+

B2 2t

t-1
k EL(wk )

k=0

k=0

 L(u) + 1 2t

w0 - u

2

+

1 2t

t-1

2(k

+ 1)2-1 2k

E

wk - u

2 + B2 2t

t-1
k EL(wk )

k=1

k=0

(i)
 L(u) +

1

2t

w0 - u

2

+

4-1 (

t

w0

2

+

ln2 t 2

+

2 1-

t-1-) 

t-1

1 k1-

+

B2 2t

t-1
k EL(wk )

k=1

k=0

 L(u) + 1 2t

w0 - u

2 + 4-1 ( t

w0

2

+

ln2 t 2

+

1

2 -

t-1-) t 

B2 +
2t

t-1
k EL(wk )

k=0



11 +(
t 2t

w0

2

+

ln2 t 2 )

+

4-1 t1- (

w0

2

+

ln2 t 2

+

1

2 -

t-) 

+

B2 2t

t-1
k EL(wk )

k=0

= O(ln2(t)/t1-)

where (i) follows from the fact that E

wk - u

2

w0

2

+

ln2 t 2

+

2 1-

t-1-

for

k



t.

Thus, we can see that L(wt) decreases to 0 to 0.5, the best convergence rate that can be

aatchaireavteedoifsOO((llnn22((tt))//t1-t).).

If

we

choose



to

be

close

F PROOF OF THEOREM 3.4

F.1 MAIN PROOF OF THEOREM 3.4

We first present four technical lemmas that are useful for the proof of the main theorem.
Lemma F.1. Given the stepsize k+1 = 1/(k + 1)- and the initialization w0s, then for t  1, we have

Ewt

 - 1 ln B 4-1
+ t1-

11 +
t 2t

w0s

2

+

ln2(t) 2

w0s

2+

ln2 t 2

+

1

2 -



t-

B2 t-1

+ 2t

k EL(wk )

k=0

(18)

Lemma F.2. Let X+ represent the data matrix of all samples with the label +1, with each row representing one sample. Then we have:

min X+T q  max min(X+w)i = .

qn-1

w =1 i

15

Under review as a conference paper at ICLR 2019

n-1 is the simplex in Rn. If the equality holds (i.e., the strong duality holds) at q and w^ +, then they satisfy
w^ + = 1 X+q, 
and w^ + is the max-margin classifier of samples with the label +1.

Lemma F.3. Let p = EL(wp) /EL(wp) and ^p+1 = p+1EL(wp) for k  1. Then we have

ln

EL(wk )



ln

L(w0)

-

k-1

^p+1p

+

1 B4S 2

k-1

p2+1.

p=0

p=0

Lemma F.4. For 0  k  t - 1, we have

E -wk, w^ +



1  (ln E(L(wk))

+ ln n+).

We next apply the lemmas to prove the main theorem. Taking the expectation of the SGD update rule yields that
Ewk = Ewk-1 - k-1EL(wk-1).
Applying the above equation recursively, we further obtain that
k-1
Ewk = w0 - pEL(wp),
p=0
which further leads to

t-1 t-1 k-1

t-2

Ewk  t w0 +

p EL(wp) = t w0 + (t - 1 - p)p EL(wp) . (19)

k=0

k=1 p=0

p=0

Next, we prove the convergence of the direction of E[wt] to the max-margin direction as follows.

1

Ewt

2
- w^ +

2 Ewt

=1-

Ewt, w^ + Ewt

t-1
E -wk, w^ + = 1 + k=0
t Ewt

(i)


1

+

t-1

ln

E(L(wk))

+

ln

n+

k=0 t Ewt

k-1

k-1

(ii)


1

+

ln n+

+ ln L(w0)

+

t-1

- ^p+1p
p=0

+

1 2

B4S

p2+1
p=0

 Ewt

k=1

t Ewt

k-1

k-1

t-1
=1-

^p+1p
p=0

+

ln n+ + ln L(w0)

+

1 B4S t-1

p2+1
p=0

k=1 t Ewt

 Ewt

2

t
k=1

Ewt

t-1 t-2

t-2

=

Ewk
k=0

- (t - 1 - p)p+1 EL(wp)
p=0

+

ln

n+

+

ln

L(w0)

+

1 B4S

(t
p=0

-

1

-

p)p2+1

t Ewt

 Ewt

2

t Ewt

t-1
Ewk  k=0

t-2
- (t - 1 - p)p+1 EL(wp)
p=0
t Ewt

t-2

+ ln n+ + ln L(w0) + 1 B4S p=0 p2+1

 Ewt

2  Ewt

(iii)


w0

+ ln n+ + ln L(w0) +

1 B4S 1 - t1-2 ,

Ewt

 Ewt

4( - 0.5)

 Ewt

16

Under review as a conference paper at ICLR 2019

where (i) follows from Lemma F.4, (ii) follows from Lemma F.3 and (iii) is due to eq. (19). Since following from Lemma F.1 we have that Ewt = O(ln(t)), the above inequality then implies that

Ewt

2
- w^ + = O

1

.

Ewt ln t

F.2 PROOF OF TECHNICAL LEMMAS

Proof of Lemma F.1. Since xi  B for all i, we obtain that

exp(-EwtT xi)  exp(- Ewt xi )  exp(-B Ewt ),

1

L(Ewt) = n+

exp(-Ewt xi)  exp(-B Ewt ).

iI +

By convexity, we have that EL(wt)  L(Ewt), combining which with the above bounds further yields

Ewt



-1 B

ln(L(Ewt))



-1 B

ln(EL(wt))



-1 B

ln

ln2 t t1-

.

That is, the increasing rate of E wt is at least O(ln(t)).

Proof of Lemma F.2. Following from the definition of the max-margin, we have

 = max min(X+w)i = max min(X+w)i

w =1 i

w 1 i

=

max(- max(-X+w)i
wi

-1

w

1)

= max(-f (-X+w) - g(w))
w

where

f (a)

=

max(a)i
i

and

g(b)

=

1

b

1,

and

their

conjugate

functions

are

f (c)

=

1cn-1

and g(e) = e , respectively, where a, b, c, d are generic vectors. We also denote f (c) and g(e)

the subgradient set of f and g at e and c respectively. By the Fenchel-Rockafellar duality Borwein

& Lewis (2010), we obtain that

 = max -f (-X+w) - g(w)  min f (q) + g(X+ q) = min X+ q .
w q qn-1

In particular, the strong duality holds at q and w^ + if and only if -X+w  f (q) and w^ + 

g(X+

q). Thus, we conclude that w^ + = g(X+

q) =

X+ q X+ q

=

1 

X+

q.

Proof of Lemma F.3. By Taylor's expansion and the update of SGD, we obtain that

L(wk )

=

L(wk-1) - kL(wk-1)T 

(wk-1, zk ) +

1 2

k2



(wk-1, zk )T 2L(w)

(wk-1, zk ),

(20)

where w = wk-1 + (1 - )wk for certain 0    1, and is in the linear separable region. Note that for any v,

vT 2L(w)v

=

1 n+

exp(-w

xi)v

xixi

v



1 n+

exp(-w xi) xi 2 v 2

iI +

iI +



v

2B2

1 n+

exp(-wT xi) = v 2B2L(w)  v 2B2S,

iI +

where S is the maximum of L(w) in the linearly separable region. We note that S < + because w   in the linearly separable region and hence L(w)  0. Taking the expectation on both
sides of eq. (20) and recalling that

E  (wk-1, xik ) 2  B2EL(wk-1),

17

Under review as a conference paper at ICLR 2019

we obtain that

EL(wk)  EL(wk-1) - kE

L(wk-1)

2+

1 2

k2

B

2S

E



(wk-1, zk )

2

 EL(wk-1)

1 - k E

L(wk-1) EL(wk-1)

2

+

1 2

k2

B

2

S

E

 (wk-1, zk ) EL(wk-1)

2

 EL(wk-1)

1 - kEL(wk-1)

EL(wk-1) [EL(wk-1)]2

2

+

1 2

k2

B

2

S

E

 (wk-1, xik ) EL(wk-1)

2

 EL

wk-1)(1 - kEL(wk-1)k2-1 +

1 2

k2

B

4

S

.

Define ^k = kEL(wk-1). Then, applying the above bound recursively yields that

EL(wk )



L(w0)

k-1
(1

-

^p+1p2

+

1 2

p2+1B4S)

p=0



k-1
L(w0)

exp(-^p+1p2

+

1 2

p2+1

B

4

S

).

p=0

(21) (22)

Denote X  Rn×d as the data matrix with each row corresponding to one data sample. The derivative of the empirical risk can be written as L(w) = XT l(w)/n, where l(w) =
[ (w, z1), (w, z2), . . . , (w, zn)] . Then, we obtain that

11

EL(wp) = n+

E exp(-wp xi) = n+ E(l(wp)) 1

iI +

and

1 EL(wp) = n+

E exp(-wp

xi)xi

=

1 n+

X+E(l(wp)).

iI +

Based on the above relationships and Lemma F.2, we obtain that

p =

EL(wp) EL(wp)

=

X+E(l(wp)) E(l(wp)) 1

=

X+ E(l(wp)) E(l(wp)) 1

 ,

Taking logarithm on both sides of eq. (22) and utilizing the above facts, we further obtain that

ln EL(wk)



ln L(w0)

-

k-1
^p+1p2

+

1 B4S 2

k-1
p2+1,

p=0

p=0



ln L(w0)

-

k-1
^p+1p

+

1 B4S 2

k-1

p2+1.

p=0

p=0

Proof of Lemma F.4. Define h(y) = ln

1 n+

exp(yi) , and then its dual function h(q) =

iI +

ln n+

+ qi ln(qi)



ln n+.

Following from Lemma

F.2,

w^ +

=

1 

X+T

q.

Then,

by the Fenchel-

Young inequality, we obtain that

E -wk, w^ +

1 =


-Ewk, X+

q

1 =


-X+Ewk, q



1 

(h(-X+Ewk

)

+

h

(q))



1 

(ln(L(Ewk

))

+ ln n+)



1 

(ln

E(L(wk

))

+

ln

n+

).

18

Under review as a conference paper at ICLR 2019

G PROOF OF PROPOSITION 2

Under our ReLU model, in the linearly separable region, the gradient L(w) is given by

1n

1

L(w) = - n

yi1{w xi>0} exp(-yiw xi)xi = - n

exp(-w xi)xi.

i=1 iI+

Thus, only samples with positive classification output, i.e. (wt xt ) > 0, contribute to the SGD updates.

We first prove wt < + when there exist misclassified samples. Suppose, toward contradiction, that wt = + as t  + when misclassified samples exist. Note that

n
wt = w0 +  iyixi
i=0

(23)

Since wt is infinite, at least one of the coefficients i, i = 1, · · · , n is infinite. No loss of generality, we assume p = +. Then, the inner product

n
wt xj = w0 xj +  iyixi xj + pypxp xj .
i=0 i=p

(24)

Based on the data selected in Proposition 2, we obtain for i  I-  I+

j  I+, yixi xj > 0 j  I-, yixi xj < 0,
which, in conjunction with eq. (24), implies that, if there exist j  I+, then the first term in the right side of eq. (24) is finite, the second term is positive, and the third term is positive and infinite. As a result, we conclude that for j  I+, wtxj > 0 as t  +. Similarly, we can prove that for j  I-, wtxj  0 as t  +, which contracts that wtxj > 0 . Thus, if there exist misclassified samples, then we have wt < +.
Based on the update rule of SGD, we have, for any j

wt+1xj - wt xj =  exp(-yt wt xt )yt xt xj = t,j .

(25)

It can be shown that

j  I-  I+, yt t,j > 0,

which, combined with eq. (25), implies that, if one sample is correctly classified at iteration t, it

remains to be correctly classified in the following iterations. Next, we prove that when wt < +, all samples are correctly classified within finite steps. Define

++

=

min
i1 I + ,i2 I +

|xi1 xi2 |;

--

=

min
i1 I - ,i2 I -

|xi1 xi2 |;

+-

=

min
i1 I + ,i2 I -

|xi1 xi2 |.

Since wt < , there exists a constant C such that wt < C for all t. Let D = maxiI+ Then, we obtain, for any j  I+ and t  I+,

xi .

t,j =  exp(-wt xt )xt xj   exp(-CD) ++,

and for any j  I+ and t  I-,

t,j = - exp(wt xt )xt xj   +-.

Combining the above two inequalities j  I+ yields

t,j   min {exp(-CD) ++,  +-}.

(26)

19

Under review as a conference paper at ICLR 2019

Similarly, we can prove j  I-

t,j  - min {exp(-CD) +-,  --}.

(27)

Combining eq. (25), eq. (26) and eq. (27), we have, when GD is in the misclassified region, the inner

product wt xi increases at least  min decreases at least  min {exp(-CD)

{exp(-CD) ++,  +-} after each ++,  +-} after each iteration for

iteratio xi 

for I-.

xi  I+ or Thus, for a

sufficiently large t, we have

i  I+, wt xi > 0 i  I-, wt xi < 0,

which shows that SGD enters into linearly separable eventually. Recall that once a sample is cor-

rectly classified, it remains to be correctly classified in the following iterations. As a result, there exists t¯  N such that the SGD stays in linearly separable region for all t  t¯.

H PROOF OF THEOREM 4.1

After T GD iterations, we randomly pick a Ar from {Ai}. Without loss of generality, we assume that only the first Kr neurons are activated for all xi  Br, and suppose there are nr samples in Br. We first use contradiction to show that all elements in the set Vr = {v1, v2, · · · , vKr } must be either all positive or all negative.

According to the update rule of GD, we have, for any 1  K1 < K2  Kr

wKt 1

L(W)

=

-

vK1 n

exp(-yiwrt xi)yixi,

xi Br

wKt 2

L(W)

=

- vK2 n

exp(-yiwrt xi)yixi,

xi Bi

which implies that

wKt 1 L(W)

=

vK1 vK2

wKt 2

L(W),

wKt+11 = wKt 1 - wKt 1 L(W),

wKt+21

=

wKt 2

-

wKt 2 L(W)

=

wKt 2

-

vK2 vK1

wKt 1 L(W).

(28)

Define the empirical risk Lr(wr) over the samples in Br as

Lr(wrt ) =

1 nr

exp(-yif (xi)) =
xi Br

1 nr

exp(-yiwrt
xi Br

xi).

Using that facts that L(W) converges to 0 and Lr(wrt )  (n/nr)L(W) implies that Lr(wrt ) converges to 0. Thus, we have yiwrt xi  0 for all xi  Br, and wrt  + as t  +. Based on eq. (28) we have, for any 1  k  Kr

wkt

= wkT

+

vk wt. v1

(29)

Recalling that wrt =

Kr k=1

vkwkt ,

we

rewrite

wrt

as

Kr

wrt =

vkwkT +

k=1

Kr vk2 k=1 v1

wt

(30)

Noting that the norm of the first term in the right side of eq. (30) is finite and recalling that wrt = +, we have, wt = +, which, in conjunction with eq. (29), implies that wkt = + for all 1  k  Kr.

Next, let us look at the update of w1 and w2. If there exist two elements in Vr that have different signs (without loss of generality, we assume v1 > 0 and v2 < 0), then

w1t+1 = w1t - w1t L(W),

w2t+1 = w2t - w2t L(W) = w1t + 

v1 v2

w1t L(W)

(31) (32)

20

Under review as a conference paper at ICLR 2019

which can be rewriten as

t-1

w1t = w1T -

w1t L(W) = w1T + wt,

s=T +1

w2t = w2T -

v1 wt. v2

Recalling that wt = + as t  + and noting that the first two neurons are activated after

T iterations, we have, for xi  Br

w1t xi = w1T xi + wt xi > 0,

w2t xi = w2T

xi -

v1 wt v2

xi

> 0.

(33)

Since wt belongs to the space spanned by the samples in Br, wt cannot be perpendicular to all xi  Br. Thus, when t  +, we can find a sample xr  Br such that wt xr = +. If wt xr > 0, then we have w2t xr < 0, which contradicts eq. (33). If wt xr < 0, then w1t xr < 0, which also contradicts eq. (33). As a result, all elements in Vr have the same sign.

Next, we prove that all samples in the same pattern partition have the same label. First consider the
case when all elements in Vr are positive. If there exists a sample xsp  Br such that ysp = -1 when t = +, then

L(W) = 1 n

n

exp(-yif (xi))

>

1 n

exp(-yspwrt

xsp)

=

1 n

exp

Kr
vkwkt xsp

1 >,
n

i=1 k=1

which contradicts that L(W) converges to 0.

Next, consider the case when all elements in Vr are negative. If there exists a sample xsp  Br such that ysp = +1, we have

L(W) = 1 n

n

exp(-yif (xi))

>

1 n

exp(-yspwrt

xsp)

=

1 n

exp(-

Kr

vk wkt

xsp)

>

1 ,
n

i=1 k=1

which also leads a contradiction. Combining these two results, we conclude that if all elements in
Vr are positive, then all samples in Br have label +1, and if all elements in Vr are negative, then all samples in Br have label -1.

Finally, note that wr is updated by

wrt+1

=

wrt

+

Kr

vkwkt L(W)

=

wrt

+

 n

Kr
vk2

exp(-yiwrt xi)yixi,

k=1

k=1

xi Br

which can be rewritten as

wrt+1

=

wrt

+

 nr n

Kr
vk2 Lr(wrt ).

k=1

(34)

Applying Theorem 3.2 to eq. (34) with stepsize ^ = n/ nr

Kr k=1

vk2

, we obtain that wrt converges

in the direction of the max-marigin classifier over all samples in Br, i.e.,

wrt wrt

- wr

=O

ln ln t ln t

.

I PROOF OF THEOREM 4.2

After T GD iterations, we randomly pick a Ar from {Ai}. Without loss of generality, we assume that only the first Kr neurons are activated for all xi  Br, and suppose there are nr samples in Br. We first use contradiction to show that all elements in the set Vr = {v1, v2, · · · , vKr } must be either all positive or all negative.

21

Under review as a conference paper at ICLR 2019

According to the update rule of SGD, for any 1  K1 < K2  Kr

wKt 1 (W) = -vK1 exp(-yt wrt xt )yt xt ,

which implies that

wKt 2 (W) = -vK2 exp(-yt wrt xt )yt xt ,

wKt 1

(W)

=

vK1 vK2

wKt 2

(W),

wKt+11 = wKt 1 - twKt 1 (W),

wKt+21 = wKt 2 - twKt 2

(W)

=

wKt 2

-

vK2 vK1

twKt 1

(W).

(35)

Then we prove wrt diverges to infinity as t  +. If wrt does not diverges to infinity, then there exist a positive constant F < + such that t  0, wrt < F . According to the update rule of

SGD

Kr

wrt+1 = wrt + t

vk2 exp(-yt wrt xt )yt xt .

k=1

For all xt  Br, we have yt wrt xt > 0, thus wrt is strictly increasing at each step. Since wrt is upper bounded by F and is in the linearly separable region, we can find a constant r > 0 such
that wrt+1  wrt + t r.
Recall t = 1/(t + 1)-, telescoping the above inequality from step T to t = +

wrt



wrT

+r

t-1

1 (1 + s) ,

s=T +1

since 0.5 <  < 1, the R.H.S of the above inequation goes to infinity, thus wrt = + when t  +, which is a contradiction. Thus, wrt diverges to infinity.

Based on eq. (28) we have, for any 1  k  Kr

wkt

= wkT

+

vk wt. v1

(36)

Recalling that wrt =

Kr k=1

vkwkt ,

we

rewrite

wrt

as

Kr

wrt =

vkwkT +

k=1

Kr vk2 k=1 v1

wt

(37)

Noting that the norm of the first term in the right side of eq. (37) is finite and recalling that wrt = +, we have, wt = +, which, in conjunction with eq. (36), implies that wkt = + for all 1  k  Kr.

Next, let us look at the update of w1 and w2. If there exist two elements in Vr that have different signs (without loss of generality, we assume v1 > 0 and v2 < 0), then

w1t+1 = w1t - tw1t (W),

w2t+1 = w2t - tw2t

(W) = w1t + t

v1 v2

w1t

(W).

(38) (39)

which can be rewriten as

t-1

w1t = w1T -

tw1t (W) = w1T + wt,

s=T +1

w2t = w2T -

v1 wt. v2

22

Under review as a conference paper at ICLR 2019

Recalling that wt = + as t  + and noting that the first two neurons are activated after T iterations, we have, for xi  Br and t > T , the following two inequalities always hold

w1t xi = w1T xi + wt xi > 0,

w2t xi = w2T

xi -

v1 wt v2

xi

> 0.

(40)

Since wt belongs to the space spanned by the samples in Br, wt cannot be perpendicular to all xi  Br. Thus, when t  +, we can find a sample xr  Br such that wt xr = +. If wt xr > 0, then we have w2t xr < 0, which contradicts eq. (40). If wt xr < 0, then w1t xr < 0, which also contradicts eq. (40). As a result, all elements in Vr have the same sign.

Next, we prove that all samples in the same pattern partition have the same label. First consider the
case when all elements in Vr are positive. If there exists a sample xsp  Br such that ysp = -1 when t = +, then

L(W) = 1 n

n

exp(-yif (xi))

>

1 n

exp(-yspwrt

xsp)

=

1 n

Kr
exp(

vk wkt

xsp)

>

1 ,
n

i=1 k=1

which contradicts that L(W) < 1/n.

Next, consider the case when all elements in Vr are negative. If there exists a sample xsp  Br such that ysp = +1, we have

L(W) = 1 n

n

exp(-yif (xi))

>

1 n

exp(-yspwrt

xsp)

=

1 n

exp(-

Kr

vk wkt

xsp)

>

1 ,
n

i=1 k=1

which also leads a contradiction. Combining these two results, we conclude that if all elements in Vr are positive, then all samples in Br have label +1, and if all elements in Vr are negative, then all samples in Br have label -1.
Finally, note that wr is updated by

Kr Kr

wrt+1 = wrt + t

vkwkt (W) = wrt + t

vk2 exp(-yiwrt xi)yixi,

k=1

k=1

which can be rewritten as

Kr

wrt+1 = wrt + t

vk2  r(wrt ).

k=1

(41)

Applying Theorem 3.4 to eq. (41) with stepsize ^t = t

Kr k=1

vk2

-1, we obtain that w rt converges

in the direction of the max-marigin classifier over all samples in Br, i.e.,

Ew rt Ew rt

2
- wr = O

1 ln t

.

23

