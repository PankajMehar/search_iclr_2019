Under review as a conference paper at ICLR 2019
LOCAL STABILITY AND PERFORMANCE OF SIMPLE GRADIENT PENALTY µ-WASSERSTEIN GAN
Anonymous authors Paper under double-blind review
ABSTRACT
Wasserstein GAN(WGAN) is a model that minimizes the Wasserstein distance between a data distribution and sample distribution. Recent studies have proposed stabilizing the training process for the WGAN and implementing the Lipschitz constraint. In this study, we prove the local stability of optimizing the simple gradient penalty µ-WGAN(SGP µ-WGAN) under suitable assumptions regarding the equilibrium and penalty measure µ. The measure valued differentiation concept is employed to deal with the derivative of the penalty terms, which is helpful for handling abstract singular measures with lower dimensional support. Based on this analysis, we claim that penalizing the data manifold or sample manifold is the key to regularizing the original WGAN with a gradient penalty. Experimental results obtained with unintuitive penalty measures that satisfy our assumptions are also provided to support our theoretical results.
1 INTRODUCTION
Deep generative models reached a turning point after generative adversarial networks (GANs) were proposed by Goodfellow et al. (2014). GANs are capable of modeling data with complex structures. For example, DCGAN can sample realistic images using a convolutional neural network (CNN) structure(Radford et al., 2015). GANs have been implemented in many applications in the field of computer vision with good results, such as super-resolution, image translation, and text-to-image generation(Ledig et al., 2017; Isola et al., 2017; Zhang et al., 2017; Reed et al., 2016).
However, despite these successes, GANs are affected by training instability and mode collapse problems. GANs often fail to converge, which can result in unrealistic fake samples. Furthermore, even if GANs successfully synthesize realistic data, the fake samples exhibit little variability. This problem is due to Jensen­Shannon divergence and the low dimensionality of the data manifold.
A common solution to this problem is injecting an instance noise and finding different divergences. The injection of instance noise into real and fake samples during the training procedure was proposed by Sønderby et al. (2017), where its positive impact on the low dimensional support for the data distribution was shown to be a regularizing factor based on the Wasserstein distance, as demonstrated analytically by Arjovsky & Bottou (2017). In f -GAN, f -divergence between the target and generator distributions was suggested which generalizes the divergence between two distributions(Nowozin et al., 2016). In addition, a gradient penalty term which is related with Sobolev IPM(Integral Probability Metric) between data distribution and sample distribution was suggested by Mroueh et al. (2018).
The Wasserstein GAN (WGAN) is known to resolve the problems of generic GANs by selecting the Wasserstein distance as the divergence(Arjovsky et al., 2017). However, WGAN often fails with simple examples because the Lipschitz constraint on discriminator is rarely achieved during the optimization process and weight clipping. Thus, mimicking the Lipschitz constraint on the discriminator by using a gradient penalty was proposed by Gulrajani et al. (2017).
Noise injection and regularizing with a gradient penalty appear to be equivalent. The addition of instance noise in f -GAN can be approximated to adding a zero centered gradient penalty(Roth et al., 2017). Thus, regularizing GAN with a simple gradient penalty term was suggested by Mescheder et al. (2018) who provided a proof of its stability.
1

Under review as a conference paper at ICLR 2019
Based on a theoretical analysis of the dynamic system, Nagarajan & Kolter (2017) proved the local exponential stability of the gradient-based optimization dynamics in GANs by treating the simultaneous gradient descent algorithm with a dynamic system approach. These previous studies were useful because they showed that the local behavior of GANs can be explained using dynamic system tools and the related Jacobian's eigenvalues.
In this study, we aim to prove the convergence property of the simple gradient penalty µ-Wasserstein GAN(SGP µ-WGAN) dynamic system under general gradient penalty measures µ. To the best of our knowledge, our study is the first theoretical approach to GAN stability analysis which deals with abstract singular penalty measure. In addition, measure valued differentiation(Heidergott & Va´zquez-Abad, 2008) is applied to take the derivative on the integral with a parametric measure, which is helpful for handling an abstract measure and its integral in our proof.
The main contributions of this study are as follows.
· We prove the regularized effect and local stability of the dynamic system for a general penalty measure under suitable assumptions. The assumptions are written as both a tractable strong version and intractable weak version. To prove the main theorem, we also introduce the measure valued differentiation concept to handle the parametric measure.
· Based on the proof of the stability, we explain the reason for the success of previous penalty measures. We claim that the support of a penalty measure will be strongly related to the stability, where the weight on the limiting penalty measure might affect the speed of convergence.
· We experimentally examined the general convergence results by applying two test penalty measures to several examples. The proposed test measures are unintuitive but they still satisfy the assumptions and similar convergence results were obtained in the experiment.
2 PRELIMINARIES
First, we introduce our notations and basic measure-theoretic concepts. Second, we define our SGP µ-WGAN optimization problem and treat this problem as a continuous dynamic system. Preliminary measure theoretic concepts are required to justify that the dynamic system changes in a sufficiently smooth manner as the parameter changes, so it is possible to use linearization theorem. They are also important for dealing with the parametric measure and its derivative. The problem setting with a simple gradient term is also discussed. The squared gradient size and simple gradient penalty term are used to build a differentiable dynamic system and to apply soft regularization as a resolving constraint, respectively. The continuous dynamic system approach, which is a so-called ODE method, is used to analyze the GAN optimization problem with the simultaneous gradient descent algorithm, as described by Nagarajan & Kolter (2017).
2.1 NOTATIONS AND PRELIMINARIES REGARDING MEASURE THEORY
D(x; ) : X  R is a discriminator function with its parameter  and G(z; ) : Z  X is a generator function with its parameter . pd is the distribution of real data and pg = p is the distribution of the generated samples in X , which is induced from the generator function G(z; ) and a known initial distribution platent(z) in the latent space Z. · denotes the L2 Euclidean norm if no special subscript is present.
The concept of weak convergence for finite measures is used to ensure the continuity of the integral term over the measure in the dynamic system, which must be checked before applying the theorems related to stability. Throughout this study, we assume that the measures in the sample space are all finite and bounded. Definition 1. For a set of finite measures {µi}iI in the metric space (X , d) with metric d and Borel -algebra B(X ), {µi}iI is referred to as bounded if there exists some M > 0 such that for all i  I,
µi(X )  M
For instance, M can be set as 1 if {µi} are probability measures on Rn. Assuming that the penalty measures are bounded, Portmanteau theorem offers the equivalent definition of the weak conver-
2

Under review as a conference paper at ICLR 2019

gence for finite measures. This definition is important for ensuring that the integrals over p and µ in the dynamic system change continuously.
Definition 2. (Portmanteau Theorem) For a bounded sequence of finite measures {µn}nN on the Euclidean space Rn with a -field of Borel subsets B(Rn), µn converges weakly to µ if and only if for every continuous bounded function  on Rn, its integrals with respect to µn converge to dµ, i.e.,
µn  µ  dµn  dµ

The most challenging problem in our analysis with the general penalty measure is taking the derivative of the integral, where the measure depends on the variable that we want to differentiate. If our penalty measure is either absolutely continuous or discrete, then it is easy to deal with the integral. However, in the case of singular penalty measure, dealing with the integral term is not an easy task. Therefore, we introduce the concept of a weak derivative of a probability measure in the following(Heidergott & Va´zquez-Abad, 2008). The weak derivative of a measure is useful for handling a parametric measure that is not absolutely continuous with low dimensional support.

Definition 3. (Weak Derivatives of a Probability Measure) Consider the Euclidean space and its -field of Borel subsets (Rd, B(Rd)). The probability measure P is called weakly differentiable at
 if a signed finite measure P exists where

d d

(x)dP

=

lim
0

1{ 

(x)dP+ -

(x)dP} =

(x)dP

is satisfied for every continuous bounded function  on Rn. For the multidimensional parameter , this can be defined similar manner.

We can show that the positive part and negative part of P have the same mass by putting (x) = 1 and the Hahn­Jordan decomposition on P. Therefore, the following triple (c, P+, P-) is called a weak derivative of P, where P± are probability measures and P is rewritten as:

P = cP+ - cP-

Therefore,

d d

(x)dP =

(x)dP = c( (x)dP+ -

(x)dP-)

holds for every continuous bounded function  on Rn. It is known that the representation of (c, P+, P-) for P is not unique because (c + C, P+ + q, P- + q) is also another representation of P.

For the general finite measure Q, a normalizing coefficient M () <  can be introduced. The product rule for differentiating can also be applied in a similar manner to calculus.

d d

(x; )dP =

(x; )dP +

(x; )dP

Therefore, for the general finite measure Q = M ()P, its derivative Q can be represented as below.
Q = M ()P + M ()P = M ()P + cM ()P+ - cM ()P-

2.2 PROBLEM SETTING AS A DYNAMIC SYSTEM

Previous work of Mescheder et al. (2018) showed that the dynamic system of WGAN-GP is not

necessarily stable at equilibrium by demonstrating that the sequence of parameters is not Cauchy

sequence. This is mainly due to the term

x

in the dynamic system which has a derivative

x x

that

is not defined at x = 0. WGAN-GP has a penalty term EµGP [( xD(x; ) - 1)2] that can lead to

a discontinuity in its dynamic system.

These problems can be avoided by using the squared value of the gradient's norm xD 2, which is a differentiable function. In contrast to the WGAN-GP, recent methods based on a gradient penalty
such as the simple gradient penalty employed by Mescheder et al. (2018) and the Sobolev GAN used

3

Under review as a conference paper at ICLR 2019

the average of the squared values for the penalty area, whereas the WGAN-GP penalizes the size of the discriminator's gradient xD away from 1 in a pointwise manner.

This advantage of squared gradient term1, Eµ[ xD 2], makes the dynamic system differentiable and we define the WGAN problem with the square of the gradient's norm as a simple gradient penalty. This simple gradient penalty can be treated as soft regularization based on the size of the discriminator's gradient, especially in case where µ is the probability measure (Roth et al., 2017). It is convenient to determine whether the system is stable by observing the spectrum of the Jacobian matrix. In the following, (D(x; ), pd, p, µ) is defined as an SGP µ-WGAN optimization problem (SGP-form) with a simple gradient penalty term on the penalty measure µ.

Definition 4. The WGAN optimization problem with a simple gradient penalty term xD 2, penalty measure µ, and penalty weight hyperparameter  > 0 is given as follows, where the penalty
term is only introduced to update the discriminator.

max


:

Epd

[D(x;

)]

-

Ep

[D(x;

)]

-

 2 Eµ[

xD(x; )

2]

min


:

Epd

[D(x;

)]

-

Ep

[D(x;

)]

According to Nagarajan & Kolter (2017) and many other optimization problem studies, the simultaneous gradient descent algorithm for GAN updating can be viewed as an autonomous dynamic system of discriminator parameters and generator parameters, which we denote as  and . As a result, the related dynamic system is given as follows.



=

Epd [D]

-

Ep [D]

-

 2



Eµ[xT

Dx

D]

 = Ep [D]

3 TOY EXAMPLES

We investigate two examples considered in previous studies by Mescheder et al. (2018) and Nagarajan & Kolter (2017). We then generalize the results to a finite measure case. The first example is the univariate Dirac GAN, which was introduced by Mescheder et al. (2018).
Definition 5. (Dirac GAN) The Dirac GAN comprises a linear discriminator D(x; ) = x, data distribution pd = 0, and sample distribution p = .
The Dirac GAN with a gradient penalty with an arbitrary probability measure is known to be globally convergent(Mescheder et al., 2018). We argue that this result can be generalized to a finite penalty measure case.
Lemma 1. Consider the Dirac GAN problem with SGP form (D(x; ) = x, 0, , µ,). Suppose that some small  > 0 exists such that its finite penalty measure µ, with mass M (, ) =
1dµ,  0 satisfies either
· M (, ) > 0 for (, )  B((0, 0)) or
· M (0, 0) = 0 and M (, )  0 for (, )  B((0, 0)).
Then, the SGP µ-WGAN optimization dynamics with (D(x; ) = x, 0, , µ,) are locally stable at the origin and the basin of attraction B = BR((0, 0)) is open ball with radius R. Its radius is given as follows.
R = max{  0|2M (, ) + M (, )  0 for all (, ) such that 2 + 2  2}
Motivated by this example, we can extend this idea to the other toy example given by Nagarajan & Kolter (2017), where WGAN fails to converge to the equilibrium points (, ) = (0, ±1).
1In this study, we prefer to use the expectation notation on the finite measure, which can be understood as follows. Suppose that µ, = M (, )µ¯, where µ¯, is normalized to the probability measure. Then, Eµ, [ xD 2] = Eµ¯, [M (, ) xD 2] = xD 2 M (, )dµ¯,(x) = xD 2 dµ,(x)

4

Under review as a conference paper at ICLR 2019

Lemma 2. Consider the toy example (D(x; ) = x2, U (-1, 1), U (-||, ||), µ) where U (0, 0) = 0 and the ideal equilibrium points are given by (, ) = (0, ±1). For a finite measure µ = µ on R which is independent of , suppose that µ  µ with µ = C0 for C  0. The dynamic system is locally stable near the desired equilibrium (0, ±1), where the spectrum of the

Jacobian at (0, ±1) is given by  = -2Eµ [x2] ±

42Eµ [x2]2

-

4 9

.

4 MAIN CONVERGENCE THEOREM

We propose the convergence property of WGAN with a simple gradient penalty on an arbitrary penalty measure µ for a realizable case:  =  with pd = p exists. In subsection 4.1, we provide the necessary assumptions, which comprise our main convergence theorem. In subsection 4.2, we give the main convergence theorem with a sketch of the proof. A more rigorous analysis is given in the Appendix.

4.1 ASSUMPTIONS

The first assumption is made regarding the equilibrium condition for GANs, where we state the ideal conditions for the discriminator parameter and generator parameter. As the parameters converge to the ideal equilibrium, the sample distribution(p) converges to the real data distribution(pd) and the discriminator cannot distinguish the generated sample and the real data. Assumption 1. p  pd as    and D(x; ) = 0 on supp(pd) and its small open neighborhood, i.e., x  x supp(pd)B x (x ) implies D(x; ) = 0. For simplicity, we denote x supp(pd)B x (x ) as B(supp(pd)).
The second assumption ensures that the higher order terms cannot affect the stability of the SGP µ-WGAN. In the Appendix, we consider the case where the WGAN fails to converge when Assumption 2 is not satisfied. Compared with the previous study by Nagarajan & Kolter (2017), the conditions for the discriminator parameter are slightly modified.
Assumption 2.
g() = Epd [D(x; )] - Ep [D(x; )] 2 , h() = Eµ, [ xD(x; ) 2]
are locally constant along the nullspace of the Hessian matrix.

The third assumption allows us to extend our results to discrete probability distribution cases, as described by Mescheder et al. (2018). Assumption 3.  g > 0 such that D(x; ) = 0 on |-|< g supp(p).

The fourth assumption indicates that there are no other "bad" equilibrium points near (, ),

which justifies the projection along the axis perpendicular to the null space.

Assumption 4. A bad equilibrium does not exist near the desired equilibrium point. Thus, (, )

is an isolated equilibrium or there exist Bg () satisfy the other assumptions.

d, g

>

0

such

that

all

equilibrium

points

in

Bd () ×

The last assumption is related to the necessary conditions for the penalty measure. A calculation of the gradient penalty based on samples from the data manifold and generator manifold or the interpolation of both was introduced in recent studies (Gulrajani et al., 2017; Roth et al., 2017; Mescheder et al., 2018). First, we propose strong conditions for the penalty measure. Assumption 5. The finite penalty measure µ = µ satisfies the followings:
a µ  µ = µ and µ is independent of the discriminator parameter .
b supp(pd)  supp(µ)
c  µ > 0 such that supp(µ)  B(supp(pd)) for | - | < µ.

The assumption given above means that the support of the penalty measure µ should approach the support of the data manifolds smoothly as   . Thus, the gradient penalty should be evaluated based on the data manifold and some open neighborhood B(supp(pd)) near the equilibrium.

5

Under review as a conference paper at ICLR 2019

However, the penalty measure from WGAN-GP with a simple gradient penalty still reaches equilibrium without satisfying Assumption 5c. Therefore, we suggest Assumption 6, which is a weak version of Assumption 5. Assumption 6a2 is technically required to take the derivative of the integral Eµ, [ xD(x; ) 2] with respect to . Assumption 6. (Weak version of Assumption 5) The finite penalty measure µ = µ, satisfies the following.
a µ,  µ, = µ, where supp(µ,) only depends on . Near the equilibrium, µ, can be weakly differentiated twice with respect to . In addition, its mass M (, ) = 1dµ, is a twice-differentiable function of  and bounded by M1 <  near the equilibrium.
b Eµ [xDTxD] is positive definite or supp(pd)  supp(µ).
c  µ > 0 such that supp(µ)  V for | - | < µ, where V = {x|xD(x; ) = 0}.
In summary, the gradient penalty regularization term with any penalty measure where the support approaches B(supp(pd)) in a smooth manner works well and this main result can explain the regularization effect of previously proposed penalty measures such as µGP , pd, p, and their mixtures.

4.2 MAIN CONVERGENCE THEOREM

According to the modified assumptions given above, we prove that the related dynamic system is locally stable near the equilibrium. The tools used for analyzing stability are mainly based on those described by Nagarajan & Kolter (2017). Our main contributions comprise proposing the necessary conditions for the penalty measure and proving the local stability for all penalty measures that satisfy Assumption 6.
Theorem 1. Suppose that our SGP µ-WGAN optimization problem (D, pd, p, µ) with equilibrium point (, ) satisfies the assumptions given above. Then, the related dynamic system is locally stable at the equilibrium.

A detailed proof of the main convergence theorem is given in the Appendix. A sketch of the proof is

given in three steps. First, the undesired terms in the Jacobian matrix of the system at the equilibrium

are cancelled out. Next, the Jacobian matrix at equilibrium is given by

-Q RT

-R 0

,

where

Q

=

Eµ [xDTxD] and R = Ep [D]|= . The system is locally stable when both Q and
RT R are positive definite. We can complete the proof by dealing with zero eigenvalues by showing that N (QT )  N (RT ) and the projected system's stability implies the original system's stability.

Our analysis mainly focuses on WGAN, which is the simplest case of general GAN minimax optimization

max


:

Epd

[f

(D(x;

))]

+

Ep

[f

(-D(x;

))]

-

 2 Eµ[

xD(x; )

2]

min


:

Epd

[f

(D(x;

))]

+

Ep

[f

(-D(x;

))]

with f (x) = x. Similar approach is still valid for general GANs with concave function f with f (x) < 0 and f (0) = 0.

5 EXPERIMENTAL RESULTS
We claim that every penalty measure that satisfies the assumptions can regularize the WGAN and generate similar results to the recently proposed gradient penalty methods. Several penalty measures were tested based on two-dimensional problems (mixture of 8 Gaussians, mixture of 25 Gaussians,
2This condition is technically required to handle the derivative of the measure in a convenient manner using the weak formulation. Even if the measure is not differentiable, it may possible to differentiate the integral. For instance,  is continuous but it does not have its weak derivative. However, it is still possible to differentiate E [(x)] = () if the function  is differentiable at .

6

Under review as a conference paper at ICLR 2019

and swissroll), MNIST and CIFAR-10 datasets using a simple gradient penalty term. In the comparisons with WGAN, the recently proposed penalty measures and our test penalty measures used the same network settings and hyperparameters. The penalty measures and its detailed sampling methods are listed in Table 1, where xd  pd, xg  p, and   U (0, 1). A indicates fixed anchor point in X .
Table 1: List of benchmark WGANs (WGAN and WGAN-GP with non-zero centered gradient penalty) and 5 penalty measures with a simple gradient penalty term. In this table, WGAN-GP represents the previous model proposed by (Gulrajani et al., 2017), which penalizes the WGAN with non-zero centered gradient penalty terms, whereas µGP represents the simple method. In our experiment, no additional weights are applied on 5 penalty measures and they are all probability distributions.

Penalty
WGAN WGAN-GP
pg pd µGP µmid µg,anc

Penalty term
None(Weight Clipping) Eµ[( xD - 1)2]
Eµ[ xD 2] Eµ[ xD 2] Eµ[ xD 2] Eµ[ xD 2] Eµ[ xD 2]

Penalty measure, sampling method
None x^ = xd + (1 - )xg
x^ = xg x^ = xd x^ = xd + (1 - )xg x^ = 0.5xd + 0.5xg x^ = A + (1 - )xg

By setting the previously proposed WGAN with weight-clipping(Arjovsky et al., 2017) and WGANGP(Gulrajani et al., 2017) as the baseline models, SGP µ-WGAN was examined with various penalty measures comprising three recently proposed measures and two artificially generated measures. p and pd were suggested by Mescheder et al. (2018) and µGP was introduced from the WGAN-GP. We analyzed the artificial penalty measures µmid and µg,anc as the test penalty measures.
The experiments were conducted based on the implementation of the Gulrajani et al. (2017). The hyperparameters, generator/discriminator structures, and related TensorFlow implementations can be found at https://github.com/igul222/improved_wgan_training (Gulrajani et al., 2017). Only the loss function was modified slightly from a non-zero centered gradient penalty to a simple penalty. For the CIFAR-10 image generation tasks, the inception score(Salimans et al., 2016) and FID(Heusel et al., 2017) were used as benchmark scores to evaluate the generated images.
5.1 2D EXAMPLES AND MNIST
We checked the convergence of p for the 2D examples (8 Gaussians, swissroll data, and 25 Gaussians) and MNIST digit generation for the SGP-WGANs with five penalty measures. MNIST and 25 Gaussians were trained over 200K iterations, the 8 Gaussians were trained for 30K iterations, and the Swiss Roll data were trained for 100K iterations. The anchor A for µg,anc was set as (2, -1) for the 2D examples and 784 gray pixels for MNIST. We only present the results obtained for the MNIST dataset with the penalty measures comprising µmid and µg,anc in Figure 1. The others are presented in the Appendix.

Figure 1: MNIST example. Images generated with µmid(left) and µg,anc(right). 7

Under review as a conference paper at ICLR 2019

5.2 CIFAR-10
DCGAN and ResNet architectures were tested on the CIFAR-10 dataset. The generators were trained for 200K iterations. The anchor A for µg,anc during CIFAR-10 generation was set as fixed random pixels. The WGAN, WGAN-GP, and five penalty measures were evaluated based on the inception score and FID, as shown in Table 2, which are useful tools for scoring the quality of generated images. The images generated from µmid and µg,anc with ResNet are shown in Figure 2. The others are presented in the Appendix.
Table 2: Benchmark score results obtained based on the CIFAR-10 dataset under DCGAN and ResNet architectures. The higher inception score and lower FID indicate the good quality of the generated images.

Penalty
WGAN 3 WGAN-GP
pg pd µGP µmid µg,anc

DCGAN Inception FID

5.64 ± 0.09 48.7 6.48 ± 0.10 35.0

6.46 ± 0.09 6.33 ± 0.07 6.40 ± 0.08 6.60 ± 0.07 6.45 ± 0.07

38.0 38.9 35.4 33.9 33.7

ResNet Inception FID

-7.82 ± 0.09 18.1

7.63 ± 0.10 7.63 ± 0.09 7.60 ± 0.09 7.86 ± 0.07 7.36 ± 0.09

20.9 20.3 18.3 16.4 22.4

Figure 2: CIFAR-10 example. Images generated with µmid(left) and µg,anc(right) under the ResNet architecture.
6 CONCLUSION
In this study, we proved the local stability of simple gradient penalty µ-WGAN optimization for a general class of finite measure µ. This proof provides insight into the success of regularization with previously proposed penalty measures. We explored previously proposed analyses based on various gradient penalty methods. Furthermore, our theoretical approach was supported by experiments using unintuitive penalty measures. In future research, our works can be extended to alternative gradient descent algorithm and its related optimal hyperparameters. Stability at non-realizable equilibrium points is one of the important topics on stability of GANs. Optimal penalty measure for achieving the best convergence speed can be also investigated using a spectral theory, which provides the mathematical analysis on stability of GAN with a precise information on the convergence theory.
3WGAN failed to generate images for the ResNet architecture
8

Under review as a conference paper at ICLR 2019
REFERENCES
Mart´in Arjovsky and Le´on Bottou. Towards principled methods for training generative adversarial networks. In International Conference on Learning Representations, 2017.
Mart´in Arjovsky, Soumith Chintala, and Le´on Bottou. Wasserstein generative adversarial networks. In Proceedings of the 34th International Conference on Machine Learning, pp. 214­223, 2017.
Ian J. Goodfellow, Jean Pouget-Abadie, Mehdi Mirza, Bing Xu, David Warde-Farley, Sherjil Ozair, Aaron C. Courville, and Yoshua Bengio. Generative adversarial nets. In Advances in Neural Information Processing Systems, pp. 2672­2680, 2014.
Ishaan Gulrajani, Faruk Ahmed, Mart´in Arjovsky, Vincent Dumoulin, and Aaron C. Courville. Improved training of wasserstein gans. In Advances in Neural Information Processing Systems, pp. 5769­5779, 2017.
B. Heidergott and F. J. Va´zquez-Abad. Measure-valued differentiation for markov chains. Journal of Optimization Theory and Applications, 136:187­209, 2008. ISSN 1573-2878. doi: 10.1007/ s10957-007-9297-7.
Martin Heusel, Hubert Ramsauer, Thomas Unterthiner, Bernhard Nessler, and Sepp Hochreiter. Gans trained by a two time-scale update rule converge to a local nash equilibrium. In Advances in Neural Information Processing Systems, pp. 6629­6640, 2017.
Phillip Isola, Jun-Yan Zhu, Tinghui Zhou, and Alexei A. Efros. Image-to-image translation with conditional adversarial networks. In 2017 IEEE Conference on Computer Vision and Pattern Recognition, CVPR 2017, Honolulu, HI, USA, July 21-26, 2017, pp. 5967­5976, 2017.
Christian Ledig, Lucas Theis, Ferenc Huszar, Jose Caballero, Andrew Cunningham, Alejandro Acosta, Andrew P. Aitken, Alykhan Tejani, Johannes Totz, Zehan Wang, and Wenzhe Shi. Photorealistic single image super-resolution using a generative adversarial network. In 2017 IEEE Conference on Computer Vision and Pattern Recognition, CVPR 2017, Honolulu, HI, USA, July 21-26, 2017, pp. 105­114, 2017.
Lars M. Mescheder, Andreas Geiger, and Sebastian Nowozin. Which training methods for gans do actually converge? In Proceedings of the 35th International Conference on Machine Learning, pp. 3478­3487, 2018.
Youssef Mroueh, Chun-Liang Li, Tom Sercu, Anant Raj, and Yu Cheng. Sobolev GAN. In International Conference on Learning Representations, 2018.
Vaishnavh Nagarajan and J. Zico Kolter. Gradient descent GAN optimization is locally stable. In Advances in Neural Information Processing Systems, pp. 5591­5600, 2017.
Sebastian Nowozin, Botond Cseke, and Ryota Tomioka. f-gan: Training generative neural samplers using variational divergence minimization. In Advances in Neural Information Processing Systems, pp. 271­279, 2016.
Alec Radford, Luke Metz, and Soumith Chintala. Unsupervised representation learning with deep convolutional generative adversarial networks. CoRR, abs/1511.06434, 2015. URL http:// arxiv.org/abs/1511.06434.
Scott E. Reed, Zeynep Akata, Xinchen Yan, Lajanugen Logeswaran, Bernt Schiele, and Honglak Lee. Generative adversarial text to image synthesis. In Proceedings of the 33nd International Conference on Machine Learning, ICML 2016, New York City, NY, USA, June 19-24, 2016, pp. 1060­ 1069, 2016. URL http://jmlr.org/proceedings/papers/v48/reed16.html.
Kevin Roth, Aure´lien Lucchi, Sebastian Nowozin, and Thomas Hofmann. Stabilizing training of generative adversarial networks through regularization. In Advances in Neural Information Processing Systems, pp. 2015­2025, 2017.
Tim Salimans, Ian J. Goodfellow, Wojciech Zaremba, Vicki Cheung, Alec Radford, and Xi Chen. Improved techniques for training gans. In Advances in Neural Information Processing Systems, pp. 2226­2234, 2016.
9

Under review as a conference paper at ICLR 2019 Casper Kaae Sønderby, Jose Caballero, Lucas Theis, Wenzhe Shi, and Ferenc Husza´r. Amortised
MAP inference for image super-resolution. International Conference on Learning Representations, 2017. Han Zhang, Tao Xu, and Hongsheng Li. Stackgan: Text to photo-realistic image synthesis with stacked generative adversarial networks. In IEEE International Conference on Computer Vision, ICCV 2017, Venice, Italy, October 22-29, 2017, pp. 5908­5916, 2017.
10

Under review as a conference paper at ICLR 2019

APPENDIX A : PROOF OF LEMMAS BASED ON TOY EXAMPLES

Proof of Lemma 1. The related dynamic system of (D(x; ) = x, 0, , µ,) can be written as follows.



=

-

-

 2



Eµ,

[

2

]

 = 

First, the only equilibrium point is given by (, ) = (0, 0) from

0 = - - 2M (, ) - 2M (, ) 0=

The corresponding Jacobian matrix for the dynamic system is written as:

J=

Z 1

-1 0

where

Z

=

-

 2



Eµ,

[

2

]

=0,=0

D(x; ) =  does not depend on x, so this can be rewritten as:

Z

=

-

 2



(2

Eµ,

[1])

=

-  (2M (, ) 2

+

4M (,

)

+

2M(, ))

=0,=0

= -M (0, 0)

Therefore, if M (0, 0) > 0, then the given system is locally stable because the eigenvalues of its linearized system have negative real parts. If M (0, 0) = 0, then the stability of the system cannot be proved by the linearization theorem. In this case, we consider the following Lyapunov function.
L((t), (t)) = (t)2 + (t)2

By differentiating with t, we obtain
L = 2( +  ) = -(2M (, )) = -(2M (, ) + 2M (, )) = -2(2M (, ) + M (, ))  0
Clearly, L(, )  0 and the equality holds iff  =  = 0. In addition, L  0 since M (, )  0 and M (, )  0 from the assumption. Furthermore, it is clear that if ((0), (0))  B((0, 0)), then (( ), ( ))  B((0, 0)) for all   0 because the Lyapunov function (square of the distance between the origin and (( ), ( ))) always decreases as   . Therefore, the given system is stable according to the Lyapunov stability theorem.
Again, we can check that if µ, is a probability measure, then the system is globally stable, as shown by Mescheder et al. (2018). The basin of attraction is given by the whole R2 plane since M (, ) = 1, so L = -2(2M + M ) = -22  0 for every (, )  R2.

Proof of Lemma 2. From the general setup of the SGP µ-WGAN optimization problem, the dynamic system corresponding to the simple-GAN in Definition 6 can be written as follows.



=

1 3

-

2 3

-

4Eµ[x2]

 = 2 3

If we let Eµ [x2] = A2, then the Jacobian matrix at the equilibrium (0, ±1) is given by J =

-4A2

±

2 3



2 3

0

. Therefore, the given system is locally stable when A = 0.

11

Under review as a conference paper at ICLR 2019

APPENDIX B : PROOF OF LEMMA RELATED WITH ASSUMPTION 2

Lemma 3. Consider the Dirac-GAN setup and SGP µ-WGAN optimization system with a slightly changed discriminator function D2(x; ) = x2. The system (D2, 0, , µGP ) does not converge to (0, 0) but for any point (a, 0) with a < 0, the system has equilibrium points on the whole -axis
and it violates Assumption 2.

Proof of Lemma 3. For the SGP µ-WGAN optimization problem (D2, 0, , µGP ), the dynamic system can be written as follows.

 = -2 - 4 2 3
 = 2

2

=

0

and

2(1

+

4 3

)

=

0

implies

that



=

0,

so

the

-axis

is

the

set

of

all

equilibrium

points.

By

drawing

the

nullclines



=

0

and



=

-

3 4

in

the

-plane,

it

is

clear

that

no

solution

curve

converges to (b, 0) with b  0, as shown in Figure 3.

Figure

3:

Phase

portrait

of

the

SGP

µ-WGAN

optimization

problem

(D2, 0, , µGP )

with



=

3 8

.

Along the line  = 0, the system is stable so no updating will occur. Every solution curve that

passes the nullcline 

=

0 has 

=

0.

For the nullcline 

=

-

3 4

=

-2, no updating on  will

occur and only  will be updated. Given that the solution curves do not intersect with each other,

every solution curve is exactly one of the following, except for some trivial cases; (1) Solution curve

stays

in

area

A.

(2)

Solution

curve

converges

to

(, )

=

(-

3 4

,

0)

along

the

nullcline



=

-

3 4

.

(3) Solution curve stays in area B. (4) Solution curve starts from area C, crosses the nullcline  = 0

perpendicularly, and converges to (b, 0) with b < 0. Therefore, no solution curve converges to (0, 0).

12

Under review as a conference paper at ICLR 2019

APPENDIX C : PROOF OF THE MAIN CONVERGENCE THEOREM

Proof. Let us consider the Jacobian matrix J =

KDD KGD

KDG KGG

at the first equilibrium (, ) 4.

J=

Epd [D]

-

Ep [D]

-

 2



Eµ

[

xD

2]

Ep [D]

-Ep [D]

-

 2



Eµ

[

xD

2]

Ep [D]

First, Assumption 1 implies that Assumption 3, Ep [D(x; )] is

lEopcda[llyzeDro]n-eaEr pthe[equiliDbr]iu=m0si,nwcehpichimppldieass

 that

.

From

KGG = Ep [D(x; )]

=0

=

We still need to evaluate Eµ[ xD 2] and Eµ[ xD 2]. According to Assumption 6a, finite signed measures µ, and µ, exist5, so they are the first and second weak derivatives of µ, with respect to the parameter  at (, ). Therefore, the expectations given above can be rewritten
as below.

I = 

xD 2 dµ,

supp(µ, )

= (2TxDxD + 2K0)dµ, + 2(TxDxD)dµ, +

xD 2 dµ,

supp(µ, )

supp(µ, )

supp(µ, )

II = 

xD 2 dµ,

supp(µ, )

= (

2(TxDxD)dµ, +

xD 2 dµ,)

supp(µ, )

supp(µ, )

where

K0(x; ) =

k



i

3 j

xk

D(x;



)

 xk

D

(x;

)

ij

From Assumption 6c and the fact that the weak derivative of µ, vanishes outside of supp(µ,), xD(x; ) = 0 on supp(µ,)  V for all  with | - | < µ and µ, = µ, = 0 on the outside of supp(µ,), which leads to the desired results:

I = 2(TxD(x; )xD(x; ))dµ
supp(µ )
II = 0

After cancelling the undesired terms, the Jacobian matrix at the equilibrium (, ) is given as:

J=

-Q RT

-R 0

where

Q = Eµ [TxDxD]

R = Ep [D]
=

4 In standard notation, g is the dim(range of g) × dim() matrix. For a real-valued function f , we

consider the first derivative as the column vector instead of the row vector. f is considered to be the

dim() × 1 matrix(column vector) of the total derivative. For the second derivative, f = ()(f ) is

the dim() × dim() matrix. The transpose notation is used in a similar manner to the matrix.

5µ, and µ, will be considered as row vector(1 × dim() matrix) and dim() × dim() matrix of

finite signed measures respectively. µ, =

 1

µ,

...

µ
dim() ,

and µ, =

µ2
ij ,

.
ij

13

Under review as a conference paper at ICLR 2019

From the definition of Q, it is easy to check that Q is at least positive semi-definite. It is known

that for a negative definite matrix A and full column rank matrix B, the block matrix

A -BT

B 0

is Hurwitz, i.e., all eigenvalues of the matrix have a negative real part. Therefore, if Q is positive

definite and R is full column rank, the proof is complete. We consider the complementary case.

Suppose that Q or RT R have some zero eigenvalues. Let Q = UDDUDT and RT R = UGGUGT with UD = [TD SD] and UG = [TG SG], where TD and TG are the eigenvectors of Q
and RT R that correspond to non-zero eigenvalues. First, we assume that TD and TG are not empty. We can show that ( + v,  + w) is also an equilibrium point for a sufficiently small ,  and v  N (Q), w  N (RT R) by using the techniques given by Nagarajan & Kolter (2017). If the system does not update at the equilibrium point (, ) and its small neighborhood ( + v,  + w) is perturbed along N (Q) and N (RT R), then it is reasonable to project the system orthogonal to N (Q) and N (RT R).

First, we assume that v  N (Q). By Assumption 2, h( + v) = h() = 0 for || < d, which implies that xD(x;  + v) = 0 for x  supp(µ+v, ) = supp(µ) and || < d. Thus, we obtain
Eµ+v, [TxD(x;  + v)xD(x;  + v)] = 0
and
xD(x;  + v) 2 dµ+v, = 0
supp(µ )

By Assumption 4, Epd [D(x;  + v)] - Ep [D(x;  + v)] = 0 since pd = p . By adding these equations, we obtain

 = Epd [D(x;  + v)] - Ep [D(x;  + v)]

- 2

2TxD(x;  + v)xD(x;  + v)dµ+v,
supp(µ+v, )

- 2

supp(µ+v, )

xD(x;  + v) 2 dµ+v,

=0

In addition,

 =  

D(x;  + v)dp
X =

= T G(z; )xD(G(z; );  + v)platent(z)dz = 0.
Z

Therefore, the point ( + v, ) with || < d is an equilibrium point. According to Assumption 4, D(x;  + v) is an equilibrium discriminator for || < d, and thus D(x;  + v) is already an optimal discriminator for || < min(d, d).

Suppose that w  N (RT R). By Assumption 2, g() = g( + w) = 0 for || < g, and thus Epd [D(x; )] - Ep+w [D(x; )] = 0 for || < g. Furthermore, Assumption 3 gives Ep+w [D(x; )] = 0 for a sufficiently close || < g, which implies that

 = Ep [D(x; )]

= 0 for || < g. Finally,

= + w

2TxD(x; )xD(x; )dµ,+w +

xD(x; ) 2 dµ,+w = 0

supp(µ,+w )

supp(µ,+w )

14

Under review as a conference paper at ICLR 2019

since supp(µ,+w)  V and xD(x; ) = 0 on V for a sufficiently small || < µ (Assumption 6c). By adding these results, we obtain

 = Epd [D(x; )] - Ep+w [D(x; )]

- 2

2TxD(x; )xD(x; )dµ,+w
supp(µ,+w )

- 2

supp(µ,+w )

xD(x; ) 2 dµ,+w

=0

Therefore, the point (,  + w) with || < min( µ, g, g, g) is an equilibrium point, which implies that p+w = pd according to Assumption 4.

If we consider the projected system (, ) = (TDT , TGT ), then the projected dynamic system's Jacobian at (TDT , TGT ) is given as follows.

J

=

-TDT QTD TGT RT TD

-TDT RTG 0

=

-(D+) TGT RT TD

-TDT RTG 0

Therefore, we only need to prove N (Q). According to Assumption

that TDT 2, h()

RTG is of full column rank. Suppose that u is locally constant at  along the direction

 u.

N (QT ) = Therefore,

for a sufficiently small scalar  with || < u,

h( + u) = h() = 0

where the last equality comes from the Assumption 6. This implies that xD(x;  + u) = 0 on x  supp(µ) for a small value of || < u. By taking directional derivative w.r.t.  along the direction u, we obtain:

uT TxD(x; ) = 0, x  supp(µ+u, ) = supp(µ)

and thus

uT TxD(x; ) = uT xD(x; ) = 0, x  supp(p ) = supp(pd)

according to Assumption 6b (the inclusion condition that supp(pd) = supp(p )  supp(µ) is required). By calculating uT R directly, we obtain

uT R = uT  
= uT  

D(x; )dp
X =
D(G(z; ); )platent(z)dz
X =

= uT xD(G(z; ); )G(z; )platent(z)dz = 0
X

Thus, we obtain u  N (RT ), which implies that N (QT )  N (RT ) and C(R)  C(Q). Now, we can check that RTG is of full column rank since TGT RT RTG = G(+) is positive definite. Therefore,

RTGw = 0  w = 0

We note that the projection matrix on C(Q) is given by TD(TDT TD)-1TDT = TDTDT . In addition, we know that C(RTG)  C(R)  C(Q). Therefore,

TDT RTGw = 0 TDTDT RTGw = 0 TDTDT w = 0, w = RTGw  C(RTG) Projection of w onto C(Q) is zero, where w  C(RTG)  C(Q)
w = RTGw = 0 w = 0

15

Under review as a conference paper at ICLR 2019

which completes the proof that TDT RTG is a full column rank matrix.

Now, we only need to obtain proofs for the trivial cases where either one of TD or TG is empty. First, suppose that TG is empty. Similar to the analysis given above, we can find that the point (, ) with | - | < min( µ, g, g, ) is an equilibrium point, where g() = g() for a sufficiently small | - | < . We conclude that p = pd for | - | < min( µ, g, g, ). Under the generator initialization that is sufficiently close according to , we can only observe the discriminator update



 = - 2 Eµ, [

xD(x; )

2]

since Epd [D(x; )] - Ep [D(x; )] discriminator update described above

= 0 for any  and | - is locally stable system near

| < min( µ, the equilibrium 

g, =

g , 

). The since the

Jacobian of the update on  is given as -Q and the zero eigenvalues can be ignored in a similar

manner to the previous step. Therefore, the given system is stable near the equilibrium.

Suppose that TD is empty. Given that N (QT )  N (RT ), R = 0, then the results are similar to those presented above, but our goal is to show that (, ) is an equilibrium point, where (, ) is sufficiently close to the original equilibrium point. We note that (, ) is also an equilibrium point
that satisfies the assumptions.

By Assumption 2, h() = h() = 0 for | - | < , which implies that xD(x; ) = 0 for x  supp(µ, ) = supp(µ) and | - | < . Thus, we obtain

Eµ, [TxD(x; )xD(x; )] = 0

 2

supp(µ )

xD 2 dµ, dx = 0

By Assumption 4, Epd [D(x; )] - Ep [D(x; )] = 0 since pd = p . In addition,

 =  

D(x; )dp

=

X =

T G(z; )xD(G(z; ); )platent(z)dz = 0
Z

Therefore, the point (, ) with | - | < min(, d) is an equilibrium point. From Assumption 4, D(x; ) is an equilibrium discriminator, and thus D(x; ) is already an optimal discriminator for | - | < min(, d) and p coincides with the data distribution pd for | - | < min( µ, g, g), which indicates that every discriminator and generator near (, ) is an equilibrium point and this
completes the proof of the main theorem.

16

Under review as a conference paper at ICLR 2019
APPENDIX D : DETAILED EXPERIMENTAL RESULTS
Figure 4: 2D example on 8 Gaussians, swissroll, 25 Gaussians datasets. Images generated with 5 penalty measures: µGP , µmid, pg, pd, µg,anc.
17

Under review as a conference paper at ICLR 2019

(a) pg (c) µGP with simple GP

(b) pd (d) µmid

(e) µg.anc Figure 5: MNIST example. Images generated with µGP , µmid, pg, pd, µg,anc.

18

Under review as a conference paper at ICLR 2019

(a) WGAN

(b) WGAN-GP

(c) pg

(d) pd

(e) µGP with simple GP

(f) µmid

(g) µg.anc

Figure 6: CIFAR-10 example.

Images generated with WGAN, WGAN-GP,

µGP , µmid, pg, pd, µg,anc under the DCGAN architecture.

19

Under review as a conference paper at ICLR 2019

(a) WGAN

(b) WGAN-GP

(c) pg

(d) pd

(e) µGP with simple GP

(f) µmid

(g) µg.anc

Figure 7: CIFAR-10 example.

Images generated with WGAN, WGAN-GP,

µGP , µmid, pg, pd, µg,anc under the ResNet architecture.

20

